import{r as d,j as m}from"./react-pyWNicHf.js";import{U as Ct,c as uo,k as mo,x as Ai,C as ho,I as fo}from"./@vavt-BhS2ZNLz.js";import{r as po}from"./react-dom-DaPlfP5C.js";import{U as go,T as vo,X as bo,S as xo,C as wo,L as ko,a as $o,E as yo,V as Co,b as To,c as Eo,M as So,d as jo,e as Xr,f as Io,F as No,R as Lo,g as Ao,I as Ro,h as Mo,i as Fo,j as Oo,k as Ho,l as _o,Q as Do,m as Po,n as zo,H as Vo,o as Wo,p as qo,q as Bo,B as Uo}from"./lucide-react-B1CG_ASX.js";import{C as Re,d as Ko,s as Go,a as Zo,h as Xo,i as Yo,k as Jo,E as ke,b as Qo,c as Yr,m as en,e as Ri,u as tn,r as rn,l as on,H as Mi,f as nn,g as wt,j as sn,p as ln,n as ze,S as an}from"./@codemirror-BUSX5JHM.js";import{c as S}from"./@lezer-BkZr8DQx.js";import{m as cn}from"./medium-zoom-bWEtUbjf.js";import{M as dn}from"./markdown-it-B_KdP_AI.js";import{r as un}from"./markdown-it-image-figures-IpqUZCLv.js";import{s as mn}from"./markdown-it-sub-Bxi31R0z.js";import{s as hn}from"./markdown-it-sup-Bp2DoVCN.js";var fn=Object.defineProperty,pn=(e,t,r)=>t in e?fn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,gn=(e,t,r)=>pn(e,t+"",r);let vn=class{constructor(){gn(this,"pools",{})}remove(t,r,i){const o=this.pools[t]&&this.pools[t][r];o&&(this.pools[t][r]=o.filter(n=>n!==i))}clear(t){this.pools[t]={}}on(t,r){return this.pools[t]||(this.pools[t]={}),this.pools[t][r.name]||(this.pools[t][r.name]=[]),this.pools[t][r.name].push(r.callback),this.pools[t][r.name].includes(r.callback)}emit(t,r,...i){this.pools[t]||(this.pools[t]={});const o=this.pools[t][r];o&&o.forEach(n=>{try{n(...i)}catch(s){console.error(`${r} monitor event exception！`,s)}})}};const E=new vn,Je="onSave",dt="changeCatalogVisible",Tt="changeFullscreen",Jr="pageFullscreenChanged",Qr="fullscreenChanged",ei="previewChanged",ti="previewOnlyChanged",ri="htmlPreviewChanged",ii="catalogVisibleChanged",Ge="buildFinished",ye="errorCatcher",K="replace",Qe="uploadImage",Et="openModals",St="ctrlZ",jt="ctrlShiftZ",Ye="catalogChanged",It="pushCatalog",ut="rerender",Nt="eventListener",Lt="taskStateChanged",At="sendEditorView",mt="getEditorView",a="md-editor",Y="https://unpkg.com",bn=`${Y}/@highlightjs/cdn-assets@11.10.0/highlight.min.js`,oi={main:`${Y}/prettier@3.3.3/standalone.js`,markdown:`${Y}/prettier@3.3.3/plugins/markdown.js`},xn={css:`${Y}/cropperjs@1.6.2/dist/cropper.min.css`,js:`${Y}/cropperjs@1.6.2/dist/cropper.min.js`},wn=`${Y}/screenfull@5.2.0/dist/screenfull.js`,kn=`${Y}/mermaid@11.9.0/dist/mermaid.min.js`,$n={js:`${Y}/katex@0.16.22/dist/katex.min.js`,css:`${Y}/katex@0.16.22/dist/katex.min.css`},Rt={a11y:{light:`${Y}/@highlightjs/cdn-assets@11.10.0/styles/a11y-light.min.css`,dark:`${Y}/@highlightjs/cdn-assets@11.10.0/styles/a11y-dark.min.css`},atom:{light:`${Y}/@highlightjs/cdn-assets@11.10.0/styles/atom-one-light.min.css`,dark:`${Y}/@highlightjs/cdn-assets@11.10.0/styles/atom-one-dark.min.css`},github:{light:`${Y}/@highlightjs/cdn-assets@11.10.0/styles/github.min.css`,dark:`${Y}/@highlightjs/cdn-assets@11.10.0/styles/github-dark.min.css`},gradient:{light:`${Y}/@highlightjs/cdn-assets@11.10.0/styles/gradient-light.min.css`,dark:`${Y}/@highlightjs/cdn-assets@11.10.0/styles/gradient-dark.min.css`},kimbie:{light:`${Y}/@highlightjs/cdn-assets@11.10.0/styles/kimbie-light.min.css`,dark:`${Y}/@highlightjs/cdn-assets@11.10.0/styles/kimbie-dark.min.css`},paraiso:{light:`${Y}/@highlightjs/cdn-assets@11.10.0/styles/paraiso-light.min.css`,dark:`${Y}/@highlightjs/cdn-assets@11.10.0/styles/paraiso-dark.min.css`},qtcreator:{light:`${Y}/@highlightjs/cdn-assets@11.10.0/styles/qtcreator-light.min.css`,dark:`${Y}/@highlightjs/cdn-assets@11.10.0/styles/qtcreator-dark.min.css`},stackoverflow:{light:`${Y}/@highlightjs/cdn-assets@11.10.0/styles/stackoverflow-light.min.css`,dark:`${Y}/@highlightjs/cdn-assets@11.10.0/styles/stackoverflow-dark.min.css`}},Fi=["bold","underline","italic","strikeThrough","-","title","sub","sup","quote","unorderedList","orderedList","task","-","codeRow","code","link","image","table","mermaid","katex","-","revoke","next","save","=","prettier","pageFullscreen","fullscreen","preview","previewOnly","htmlPreview","catalog","github"],Oi=["markdownTotal","=","scrollSwitch"],Mt={"zh-CN":{toolbarTips:{bold:"加粗",underline:"下划线",italic:"斜体",strikeThrough:"删除线",title:"标题",sub:"下标",sup:"上标",quote:"引用",unorderedList:"无序列表",orderedList:"有序列表",task:"任务列表",codeRow:"行内代码",code:"块级代码",link:"链接",image:"图片",table:"表格",mermaid:"mermaid图",katex:"katex公式",revoke:"后退",next:"前进",save:"保存",prettier:"美化",pageFullscreen:"浏览器全屏",fullscreen:"屏幕全屏",preview:"预览",previewOnly:"仅预览",htmlPreview:"html代码预览",catalog:"目录",github:"源码地址"},titleItem:{h1:"一级标题",h2:"二级标题",h3:"三级标题",h4:"四级标题",h5:"五级标题",h6:"六级标题"},imgTitleItem:{link:"添加链接",upload:"上传图片",clip2upload:"裁剪上传"},linkModalTips:{linkTitle:"添加链接",imageTitle:"添加图片",descLabel:"链接描述：",descLabelPlaceHolder:"请输入描述...",urlLabel:"链接地址：",urlLabelPlaceHolder:"请输入链接...",buttonOK:"确定"},clipModalTips:{title:"裁剪图片上传",buttonUpload:"上传"},copyCode:{text:"复制代码",successTips:"已复制！",failTips:"复制失败！"},mermaid:{flow:"流程图",sequence:"时序图",gantt:"甘特图",class:"类图",state:"状态图",pie:"饼图",relationship:"关系图",journey:"旅程图"},katex:{inline:"行内公式",block:"块级公式"},footer:{markdownTotal:"字数",scrollAuto:"同步滚动"}},"en-US":{toolbarTips:{bold:"bold",underline:"underline",italic:"italic",strikeThrough:"strikeThrough",title:"title",sub:"subscript",sup:"superscript",quote:"quote",unorderedList:"unordered list",orderedList:"ordered list",task:"task list",codeRow:"inline code",code:"block-level code",link:"link",image:"image",table:"table",mermaid:"mermaid",katex:"formula",revoke:"revoke",next:"undo revoke",save:"save",prettier:"prettier",pageFullscreen:"fullscreen in page",fullscreen:"fullscreen",preview:"preview",previewOnly:"preview only",htmlPreview:"html preview",catalog:"catalog",github:"source code"},titleItem:{h1:"Lv1 Heading",h2:"Lv2 Heading",h3:"Lv3 Heading",h4:"Lv4 Heading",h5:"Lv5 Heading",h6:"Lv6 Heading"},imgTitleItem:{link:"Add Image Link",upload:"Upload Images",clip2upload:"Crop And Upload"},linkModalTips:{linkTitle:"Add Link",imageTitle:"Add Image",descLabel:"Desc:",descLabelPlaceHolder:"Enter a description...",urlLabel:"Link:",urlLabelPlaceHolder:"Enter a link...",buttonOK:"OK"},clipModalTips:{title:"Crop Image",buttonUpload:"Upload"},copyCode:{text:"Copy",successTips:"Copied!",failTips:"Copy failed!"},mermaid:{flow:"flow",sequence:"sequence",gantt:"gantt",class:"class",state:"state",pie:"pie",relationship:"relationship",journey:"journey"},katex:{inline:"inline",block:"block"},footer:{markdownTotal:"Character Count",scrollAuto:"Scroll Auto"}}},A={modelValue:"",theme:"light",className:"",onChange:()=>{},pageFullscreen:!1,preview:!0,htmlPreview:!1,language:"zh-CN",toolbars:Fi,toolbarsExclude:[],noPrettier:!1,onHtmlChanged:()=>{},onGetCatalog:()=>{},tabWidth:2,showCodeRowNumber:!0,previewTheme:"default",mdHeadingId:e=>e,tableShape:[6,4],noMermaid:!1,sanitize:e=>e,placeholder:"",noKatex:!1,defToolbars:[],onError:()=>{},codeTheme:"atom",footers:Oi,defFooters:[],noUploadImg:!1,codeStyleReverse:!0,codeStyleReverseList:["default","mk-cute"],noHighlight:!1,noImgZoomIn:!1,inputBoxWidth:"50%",sanitizeMermaid:e=>Promise.resolve(e),transformImgUrl:e=>e,codeFoldable:!0,autoFoldThreshold:30,catalogLayout:"fixed"},re={editorExtensions:{highlight:{js:bn,css:Rt},prettier:{standaloneJs:oi.main,parserMarkdownJs:oi.markdown},cropper:{...xn},screenfull:{js:wn},mermaid:{js:kn,enableZoom:!0},katex:{...$n}},editorExtensionsAttrs:{},editorConfig:{languageUserDefined:{},mermaidTemplate:{},renderDelay:500,zIndex:2e4},codeMirrorExtensions:(e,t)=>t,markdownItConfig:()=>{},markdownItPlugins:e=>e,mermaidConfig:e=>e,katexConfig:e=>e},tt=.1,yn={copy:`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy ${a}-icon"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>`,"collapse-tips":`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-chevron-left ${a}-icon"><circle cx="12" cy="12" r="10"/><path d="m14 16-4-4 4-4"/></svg>`,pin:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pin"><path d="M12 17v5"/><path d="M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z"/></svg>',"pin-off":'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pin-off"><path d="M12 17v5"/><path d="M15 9.34V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H7.89"/><path d="m2 2 20 20"/><path d="M9 9v1.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h11"/></svg>'},st=(e,t)=>typeof t[e]=="string"?t[e]:yn[e],Cn=(e,t)=>{const r=i=>{const o=e.parentElement||document.body,n=o.offsetWidth,s=o.offsetHeight,{clientWidth:l,clientHeight:c}=document.documentElement,g=i.offsetX,f=i.offsetY,u=v=>{let w=v.x+document.body.scrollLeft-document.body.clientLeft-g,k=v.y+document.body.scrollTop-document.body.clientTop-f;w=w<1?1:w<l-n-1?w:l-n-1,k=k<1?1:k<c-s-1?k:c-s-1,t?t(w,k):(o.style.left=w+"px",o.style.top=k+"px")};document.addEventListener("mousemove",u);const h=()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",h)};document.addEventListener("mouseup",h)};return e.addEventListener("mousedown",r),()=>{e.removeEventListener("mousedown",r)}},ge=(e,t,r="")=>{var i;const o=document.getElementById(t.id);if(o)r!==""&&(Reflect.get(window,r)?(i=t.onload)==null||i.call(o,new Event("load")):t.onload&&o.addEventListener("load",t.onload));else{const n={...t};n.onload=null;const s=En(e,n);t.onload&&s.addEventListener("load",t.onload),document.head.appendChild(s)}},Tn=(e,t)=>{const r=document.getElementById(t.id);r?.remove(),ge(e,t)},En=(e,t)=>{const r=document.createElement(e);return Object.keys(t).forEach(i=>{t[i]!==void 0&&(r[i]=t[i])}),r},ni=(()=>{const e=t=>{if(!t)return()=>{};const r=t.firstChild;let i=1,o=0,n=0,s=!1,l,c,g,f=1;const u=()=>{r.style.transform=`translate(${o}px, ${n}px) scale(${i})`},h=x=>{x.touches.length===1?(s=!0,l=x.touches[0].clientX-o,c=x.touches[0].clientY-n):x.touches.length===2&&(g=Math.hypot(x.touches[0].clientX-x.touches[1].clientX,x.touches[0].clientY-x.touches[1].clientY),f=i)},v=x=>{if(x.preventDefault(),s&&x.touches.length===1)o=x.touches[0].clientX-l,n=x.touches[0].clientY-c,u();else if(x.touches.length===2){const T=Math.hypot(x.touches[0].clientX-x.touches[1].clientX,x.touches[0].clientY-x.touches[1].clientY)/g,N=i;i=f*(1+(T-1));const I=(x.touches[0].clientX+x.touches[1].clientX)/2,j=(x.touches[0].clientY+x.touches[1].clientY)/2,L=r.getBoundingClientRect(),O=(I-L.left)/N,F=(j-L.top)/N;o-=O*(i-N),n-=F*(i-N),u()}},w=()=>{s=!1},k=x=>{x.preventDefault();const T=.02,N=i;x.deltaY<0?i+=T:i=Math.max(.1,i-T);const I=r.getBoundingClientRect(),j=x.clientX-I.left,L=x.clientY-I.top;o-=j/N*(i-N),n-=L/N*(i-N),u()},y=x=>{s=!0,l=x.clientX-o,c=x.clientY-n},p=x=>{s&&(o=x.clientX-l,n=x.clientY-c,u())},b=()=>{s=!1},C=()=>{s=!1};return t.addEventListener("touchstart",h,{passive:!1}),t.addEventListener("touchmove",v,{passive:!1}),t.addEventListener("touchend",w),t.addEventListener("wheel",k,{passive:!1}),t.addEventListener("mousedown",y),t.addEventListener("mousemove",p),t.addEventListener("mouseup",b),t.addEventListener("mouseleave",C),()=>{t.removeEventListener("touchstart",h),t.removeEventListener("touchmove",v),t.removeEventListener("touchend",w),t.removeEventListener("wheel",k),t.removeEventListener("mousedown",y),t.removeEventListener("mousemove",p),t.removeEventListener("mouseup",b),t.removeEventListener("mouseleave",C)}};return(t,r)=>{const i=new Map;return t?.forEach(o=>{let n=o.querySelector(`.${a}-mermaid-action`);n||(o.insertAdjacentHTML("beforeend",`<div class="${a}-mermaid-action">${st("pin-off",r.customIcon)}</div>`),n=o.querySelector(`.${a}-mermaid-action`));const s=()=>{const l=i.get(o);if(l!=null&&l.removeEvent)l.removeEvent(),o.removeAttribute("data-grab"),i.set(o,{removeClick:l.removeClick}),n.innerHTML=st("pin-off",r.customIcon);else{const c=e(o);o.setAttribute("data-grab",""),i.set(o,{removeEvent:c,removeClick:l?.removeClick}),n.innerHTML=st("pin",r.customIcon)}};n.addEventListener("click",s),i.set(o,{removeClick:()=>n.removeEventListener("click",s)})}),()=>{i.forEach(({removeEvent:o,removeClick:n})=>{o?.(),n?.()}),i.clear()}}})(),ee=d.createContext({editorId:"",tabWidth:2,theme:"light",language:"zh-CN",highlight:{css:"",js:""},showCodeRowNumber:!1,usedLanguageText:Mt["zh-CN"],previewTheme:"default",customIcon:{},rootRef:null,disabled:void 0}),Sn=(e,t="image.png")=>{const r=e.split(","),i=r[0].match(/:(.*?);/);if(i){const o=i[1],n=atob(r[1]);let s=n.length;const l=new Uint8Array(s);for(;s--;)l[s]=n.charCodeAt(s);return new File([l],t,{type:o})}return null},jn=(e,t)=>{if(!e)return e;const r=t.split(`
`),i=['<span rn-wrapper aria-hidden="true">'];return r.forEach(()=>{i.push("<span></span>")}),i.push("</span>"),`<span class="${a}-code-block">${e}</span>${i.join("")}`},P=e=>e.filter(t=>t!==!1&&t!==void 0).join(" "),In=(e,t)=>{if(!e||!t)return 0;const r=e?.getBoundingClientRect();if(t===document.documentElement)return r.top-t.clientTop;const i=t?.getBoundingClientRect();return r.top-i.top},si=(()=>{let e=0;return()=>++e})(),He=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Hi=new Set,Ft=typeof process=="object"&&process?process:{},_i=(e,t,r,i)=>{typeof Ft.emitWarning=="function"?Ft.emitWarning(e,t,r,i):console.error(`[${r}] ${t}: ${e}`)};let ht=globalThis.AbortController,li=globalThis.AbortSignal;if(typeof ht>"u"){li=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(i,o){this._onabort.push(o)}},ht=class{constructor(){t()}signal=new li;abort(i){if(!this.signal.aborted){this.signal.reason=i,this.signal.aborted=!0;for(const o of this.signal._onabort)o(i);this.signal.onabort?.(i)}}};let e=Ft.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1";const t=()=>{e&&(e=!1,_i("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",t))}}const Nn=e=>!Hi.has(e),Ie=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),Di=e=>Ie(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?lt:null:null;class lt extends Array{constructor(t){super(t),this.fill(0)}}class De{heap;length;static#a=!1;static create(t){const r=Di(t);if(!r)return[];De.#a=!0;const i=new De(t,r);return De.#a=!1,i}constructor(t,r){if(!De.#a)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new r(t),this.length=0}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}}class Ht{#a;#u;#p;#S;#g;#L;#A;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#o;#v;#i;#r;#e;#c;#m;#l;#n;#b;#s;#x;#w;#h;#k;#E;#d;#R;static unsafeExposeInternals(t){return{starts:t.#w,ttls:t.#h,sizes:t.#x,keyMap:t.#i,keyList:t.#r,valList:t.#e,next:t.#c,prev:t.#m,get head(){return t.#l},get tail(){return t.#n},free:t.#b,isBackgroundFetch:r=>t.#t(r),backgroundFetch:(r,i,o,n)=>t.#O(r,i,o,n),moveToTail:r=>t.#N(r),indexes:r=>t.#$(r),rindexes:r=>t.#y(r),isStale:r=>t.#f(r)}}get max(){return this.#a}get maxSize(){return this.#u}get calculatedSize(){return this.#v}get size(){return this.#o}get fetchMethod(){return this.#L}get memoMethod(){return this.#A}get dispose(){return this.#p}get onInsert(){return this.#S}get disposeAfter(){return this.#g}constructor(t){const{max:r=0,ttl:i,ttlResolution:o=1,ttlAutopurge:n,updateAgeOnGet:s,updateAgeOnHas:l,allowStale:c,dispose:g,onInsert:f,disposeAfter:u,noDisposeOnSet:h,noUpdateTTL:v,maxSize:w=0,maxEntrySize:k=0,sizeCalculation:y,fetchMethod:p,memoMethod:b,noDeleteOnFetchRejection:C,noDeleteOnStaleGet:x,allowStaleOnFetchRejection:T,allowStaleOnFetchAbort:N,ignoreFetchAbort:I}=t;if(r!==0&&!Ie(r))throw new TypeError("max option must be a nonnegative integer");const j=r?Di(r):Array;if(!j)throw new Error("invalid max value: "+r);if(this.#a=r,this.#u=w,this.maxEntrySize=k||this.#u,this.sizeCalculation=y,this.sizeCalculation){if(!this.#u&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(b!==void 0&&typeof b!="function")throw new TypeError("memoMethod must be a function if defined");if(this.#A=b,p!==void 0&&typeof p!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#L=p,this.#E=!!p,this.#i=new Map,this.#r=new Array(r).fill(void 0),this.#e=new Array(r).fill(void 0),this.#c=new j(r),this.#m=new j(r),this.#l=0,this.#n=0,this.#b=De.create(r),this.#o=0,this.#v=0,typeof g=="function"&&(this.#p=g),typeof f=="function"&&(this.#S=f),typeof u=="function"?(this.#g=u,this.#s=[]):(this.#g=void 0,this.#s=void 0),this.#k=!!this.#p,this.#R=!!this.#S,this.#d=!!this.#g,this.noDisposeOnSet=!!h,this.noUpdateTTL=!!v,this.noDeleteOnFetchRejection=!!C,this.allowStaleOnFetchRejection=!!T,this.allowStaleOnFetchAbort=!!N,this.ignoreFetchAbort=!!I,this.maxEntrySize!==0){if(this.#u!==0&&!Ie(this.#u))throw new TypeError("maxSize must be a positive integer if specified");if(!Ie(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#W()}if(this.allowStale=!!c,this.noDeleteOnStaleGet=!!x,this.updateAgeOnGet=!!s,this.updateAgeOnHas=!!l,this.ttlResolution=Ie(o)||o===0?o:1,this.ttlAutopurge=!!n,this.ttl=i||0,this.ttl){if(!Ie(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#H()}if(this.#a===0&&this.ttl===0&&this.#u===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#a&&!this.#u){const L="LRU_CACHE_UNBOUNDED";Nn(L)&&(Hi.add(L),_i("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",L,Ht))}}getRemainingTTL(t){return this.#i.has(t)?1/0:0}#H(){const t=new lt(this.#a),r=new lt(this.#a);this.#h=t,this.#w=r,this.#_=(n,s,l=He.now())=>{if(r[n]=s!==0?l:0,t[n]=s,s!==0&&this.ttlAutopurge){const c=setTimeout(()=>{this.#f(n)&&this.#C(this.#r[n],"expire")},s+1);c.unref&&c.unref()}},this.#j=n=>{r[n]=t[n]!==0?He.now():0},this.#T=(n,s)=>{if(t[s]){const l=t[s],c=r[s];if(!l||!c)return;n.ttl=l,n.start=c,n.now=i||o();const g=n.now-c;n.remainingTTL=l-g}};let i=0;const o=()=>{const n=He.now();if(this.ttlResolution>0){i=n;const s=setTimeout(()=>i=0,this.ttlResolution);s.unref&&s.unref()}return n};this.getRemainingTTL=n=>{const s=this.#i.get(n);if(s===void 0)return 0;const l=t[s],c=r[s];if(!l||!c)return 1/0;const g=(i||o())-c;return l-g},this.#f=n=>{const s=r[n],l=t[n];return!!l&&!!s&&(i||o())-s>l}}#j=()=>{};#T=()=>{};#_=()=>{};#f=()=>!1;#W(){const t=new lt(this.#a);this.#v=0,this.#x=t,this.#I=r=>{this.#v-=t[r],t[r]=0},this.#D=(r,i,o,n)=>{if(this.#t(i))return 0;if(!Ie(o))if(n){if(typeof n!="function")throw new TypeError("sizeCalculation must be a function");if(o=n(i,r),!Ie(o))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return o},this.#M=(r,i,o)=>{if(t[r]=i,this.#u){const n=this.#u-t[r];for(;this.#v>n;)this.#F(!0)}this.#v+=t[r],o&&(o.entrySize=i,o.totalCalculatedSize=this.#v)}}#I=t=>{};#M=(t,r,i)=>{};#D=(t,r,i,o)=>{if(i||o)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#$({allowStale:t=this.allowStale}={}){if(this.#o)for(let r=this.#n;!(!this.#P(r)||((t||!this.#f(r))&&(yield r),r===this.#l));)r=this.#m[r]}*#y({allowStale:t=this.allowStale}={}){if(this.#o)for(let r=this.#l;!(!this.#P(r)||((t||!this.#f(r))&&(yield r),r===this.#n));)r=this.#c[r]}#P(t){return t!==void 0&&this.#i.get(this.#r[t])===t}*entries(){for(const t of this.#$())this.#e[t]!==void 0&&this.#r[t]!==void 0&&!this.#t(this.#e[t])&&(yield[this.#r[t],this.#e[t]])}*rentries(){for(const t of this.#y())this.#e[t]!==void 0&&this.#r[t]!==void 0&&!this.#t(this.#e[t])&&(yield[this.#r[t],this.#e[t]])}*keys(){for(const t of this.#$()){const r=this.#r[t];r!==void 0&&!this.#t(this.#e[t])&&(yield r)}}*rkeys(){for(const t of this.#y()){const r=this.#r[t];r!==void 0&&!this.#t(this.#e[t])&&(yield r)}}*values(){for(const t of this.#$())this.#e[t]!==void 0&&!this.#t(this.#e[t])&&(yield this.#e[t])}*rvalues(){for(const t of this.#y())this.#e[t]!==void 0&&!this.#t(this.#e[t])&&(yield this.#e[t])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(t,r={}){for(const i of this.#$()){const o=this.#e[i],n=this.#t(o)?o.__staleWhileFetching:o;if(n!==void 0&&t(n,this.#r[i],this))return this.get(this.#r[i],r)}}forEach(t,r=this){for(const i of this.#$()){const o=this.#e[i],n=this.#t(o)?o.__staleWhileFetching:o;n!==void 0&&t.call(r,n,this.#r[i],this)}}rforEach(t,r=this){for(const i of this.#y()){const o=this.#e[i],n=this.#t(o)?o.__staleWhileFetching:o;n!==void 0&&t.call(r,n,this.#r[i],this)}}purgeStale(){let t=!1;for(const r of this.#y({allowStale:!0}))this.#f(r)&&(this.#C(this.#r[r],"expire"),t=!0);return t}info(t){const r=this.#i.get(t);if(r===void 0)return;const i=this.#e[r],o=this.#t(i)?i.__staleWhileFetching:i;if(o===void 0)return;const n={value:o};if(this.#h&&this.#w){const s=this.#h[r],l=this.#w[r];if(s&&l){const c=s-(He.now()-l);n.ttl=c,n.start=Date.now()}}return this.#x&&(n.size=this.#x[r]),n}dump(){const t=[];for(const r of this.#$({allowStale:!0})){const i=this.#r[r],o=this.#e[r],n=this.#t(o)?o.__staleWhileFetching:o;if(n===void 0||i===void 0)continue;const s={value:n};if(this.#h&&this.#w){s.ttl=this.#h[r];const l=He.now()-this.#w[r];s.start=Math.floor(Date.now()-l)}this.#x&&(s.size=this.#x[r]),t.unshift([i,s])}return t}load(t){this.clear();for(const[r,i]of t){if(i.start){const o=Date.now()-i.start;i.start=He.now()-o}this.set(r,i.value,i)}}set(t,r,i={}){if(r===void 0)return this.delete(t),this;const{ttl:o=this.ttl,start:n,noDisposeOnSet:s=this.noDisposeOnSet,sizeCalculation:l=this.sizeCalculation,status:c}=i;let{noUpdateTTL:g=this.noUpdateTTL}=i;const f=this.#D(t,r,i.size||0,l);if(this.maxEntrySize&&f>this.maxEntrySize)return c&&(c.set="miss",c.maxEntrySizeExceeded=!0),this.#C(t,"set"),this;let u=this.#o===0?void 0:this.#i.get(t);if(u===void 0)u=this.#o===0?this.#n:this.#b.length!==0?this.#b.pop():this.#o===this.#a?this.#F(!1):this.#o,this.#r[u]=t,this.#e[u]=r,this.#i.set(t,u),this.#c[this.#n]=u,this.#m[u]=this.#n,this.#n=u,this.#o++,this.#M(u,f,c),c&&(c.set="add"),g=!1,this.#R&&this.#S?.(r,t,"add");else{this.#N(u);const h=this.#e[u];if(r!==h){if(this.#E&&this.#t(h)){h.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:v}=h;v!==void 0&&!s&&(this.#k&&this.#p?.(v,t,"set"),this.#d&&this.#s?.push([v,t,"set"]))}else s||(this.#k&&this.#p?.(h,t,"set"),this.#d&&this.#s?.push([h,t,"set"]));if(this.#I(u),this.#M(u,f,c),this.#e[u]=r,c){c.set="replace";const v=h&&this.#t(h)?h.__staleWhileFetching:h;v!==void 0&&(c.oldValue=v)}}else c&&(c.set="update");this.#R&&this.onInsert?.(r,t,r===h?"update":"replace")}if(o!==0&&!this.#h&&this.#H(),this.#h&&(g||this.#_(u,o,n),c&&this.#T(c,u)),!s&&this.#d&&this.#s){const h=this.#s;let v;for(;v=h?.shift();)this.#g?.(...v)}return this}pop(){try{for(;this.#o;){const t=this.#e[this.#l];if(this.#F(!0),this.#t(t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(t!==void 0)return t}}finally{if(this.#d&&this.#s){const t=this.#s;let r;for(;r=t?.shift();)this.#g?.(...r)}}}#F(t){const r=this.#l,i=this.#r[r],o=this.#e[r];return this.#E&&this.#t(o)?o.__abortController.abort(new Error("evicted")):(this.#k||this.#d)&&(this.#k&&this.#p?.(o,i,"evict"),this.#d&&this.#s?.push([o,i,"evict"])),this.#I(r),t&&(this.#r[r]=void 0,this.#e[r]=void 0,this.#b.push(r)),this.#o===1?(this.#l=this.#n=0,this.#b.length=0):this.#l=this.#c[r],this.#i.delete(i),this.#o--,r}has(t,r={}){const{updateAgeOnHas:i=this.updateAgeOnHas,status:o}=r,n=this.#i.get(t);if(n!==void 0){const s=this.#e[n];if(this.#t(s)&&s.__staleWhileFetching===void 0)return!1;if(this.#f(n))o&&(o.has="stale",this.#T(o,n));else return i&&this.#j(n),o&&(o.has="hit",this.#T(o,n)),!0}else o&&(o.has="miss");return!1}peek(t,r={}){const{allowStale:i=this.allowStale}=r,o=this.#i.get(t);if(o===void 0||!i&&this.#f(o))return;const n=this.#e[o];return this.#t(n)?n.__staleWhileFetching:n}#O(t,r,i,o){const n=r===void 0?void 0:this.#e[r];if(this.#t(n))return n;const s=new ht,{signal:l}=i;l?.addEventListener("abort",()=>s.abort(l.reason),{signal:s.signal});const c={signal:s.signal,options:i,context:o},g=(k,y=!1)=>{const{aborted:p}=s.signal,b=i.ignoreFetchAbort&&k!==void 0;if(i.status&&(p&&!y?(i.status.fetchAborted=!0,i.status.fetchError=s.signal.reason,b&&(i.status.fetchAbortIgnored=!0)):i.status.fetchResolved=!0),p&&!b&&!y)return u(s.signal.reason);const C=v;return this.#e[r]===v&&(k===void 0?C.__staleWhileFetching?this.#e[r]=C.__staleWhileFetching:this.#C(t,"fetch"):(i.status&&(i.status.fetchUpdated=!0),this.set(t,k,c.options))),k},f=k=>(i.status&&(i.status.fetchRejected=!0,i.status.fetchError=k),u(k)),u=k=>{const{aborted:y}=s.signal,p=y&&i.allowStaleOnFetchAbort,b=p||i.allowStaleOnFetchRejection,C=b||i.noDeleteOnFetchRejection,x=v;if(this.#e[r]===v&&(!C||x.__staleWhileFetching===void 0?this.#C(t,"fetch"):p||(this.#e[r]=x.__staleWhileFetching)),b)return i.status&&x.__staleWhileFetching!==void 0&&(i.status.returnedStale=!0),x.__staleWhileFetching;if(x.__returned===x)throw k},h=(k,y)=>{const p=this.#L?.(t,n,c);p&&p instanceof Promise&&p.then(b=>k(b===void 0?void 0:b),y),s.signal.addEventListener("abort",()=>{(!i.ignoreFetchAbort||i.allowStaleOnFetchAbort)&&(k(void 0),i.allowStaleOnFetchAbort&&(k=b=>g(b,!0)))})};i.status&&(i.status.fetchDispatched=!0);const v=new Promise(h).then(g,f),w=Object.assign(v,{__abortController:s,__staleWhileFetching:n,__returned:void 0});return r===void 0?(this.set(t,w,{...c.options,status:void 0}),r=this.#i.get(t)):this.#e[r]=w,w}#t(t){if(!this.#E)return!1;const r=t;return!!r&&r instanceof Promise&&r.hasOwnProperty("__staleWhileFetching")&&r.__abortController instanceof ht}async fetch(t,r={}){const{allowStale:i=this.allowStale,updateAgeOnGet:o=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:l=this.noDisposeOnSet,size:c=0,sizeCalculation:g=this.sizeCalculation,noUpdateTTL:f=this.noUpdateTTL,noDeleteOnFetchRejection:u=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:h=this.allowStaleOnFetchRejection,ignoreFetchAbort:v=this.ignoreFetchAbort,allowStaleOnFetchAbort:w=this.allowStaleOnFetchAbort,context:k,forceRefresh:y=!1,status:p,signal:b}=r;if(!this.#E)return p&&(p.fetch="get"),this.get(t,{allowStale:i,updateAgeOnGet:o,noDeleteOnStaleGet:n,status:p});const C={allowStale:i,updateAgeOnGet:o,noDeleteOnStaleGet:n,ttl:s,noDisposeOnSet:l,size:c,sizeCalculation:g,noUpdateTTL:f,noDeleteOnFetchRejection:u,allowStaleOnFetchRejection:h,allowStaleOnFetchAbort:w,ignoreFetchAbort:v,status:p,signal:b};let x=this.#i.get(t);if(x===void 0){p&&(p.fetch="miss");const T=this.#O(t,x,C,k);return T.__returned=T}else{const T=this.#e[x];if(this.#t(T)){const O=i&&T.__staleWhileFetching!==void 0;return p&&(p.fetch="inflight",O&&(p.returnedStale=!0)),O?T.__staleWhileFetching:T.__returned=T}const N=this.#f(x);if(!y&&!N)return p&&(p.fetch="hit"),this.#N(x),o&&this.#j(x),p&&this.#T(p,x),T;const I=this.#O(t,x,C,k),L=I.__staleWhileFetching!==void 0&&i;return p&&(p.fetch=N?"stale":"refresh",L&&N&&(p.returnedStale=!0)),L?I.__staleWhileFetching:I.__returned=I}}async forceFetch(t,r={}){const i=await this.fetch(t,r);if(i===void 0)throw new Error("fetch() returned undefined");return i}memo(t,r={}){const i=this.#A;if(!i)throw new Error("no memoMethod provided to constructor");const{context:o,forceRefresh:n,...s}=r,l=this.get(t,s);if(!n&&l!==void 0)return l;const c=i(t,l,{options:s,context:o});return this.set(t,c,s),c}get(t,r={}){const{allowStale:i=this.allowStale,updateAgeOnGet:o=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,status:s}=r,l=this.#i.get(t);if(l!==void 0){const c=this.#e[l],g=this.#t(c);return s&&this.#T(s,l),this.#f(l)?(s&&(s.get="stale"),g?(s&&i&&c.__staleWhileFetching!==void 0&&(s.returnedStale=!0),i?c.__staleWhileFetching:void 0):(n||this.#C(t,"expire"),s&&i&&(s.returnedStale=!0),i?c:void 0)):(s&&(s.get="hit"),g?c.__staleWhileFetching:(this.#N(l),o&&this.#j(l),c))}else s&&(s.get="miss")}#z(t,r){this.#m[r]=t,this.#c[t]=r}#N(t){t!==this.#n&&(t===this.#l?this.#l=this.#c[t]:this.#z(this.#m[t],this.#c[t]),this.#z(this.#n,t),this.#n=t)}delete(t){return this.#C(t,"delete")}#C(t,r){let i=!1;if(this.#o!==0){const o=this.#i.get(t);if(o!==void 0)if(i=!0,this.#o===1)this.#V(r);else{this.#I(o);const n=this.#e[o];if(this.#t(n)?n.__abortController.abort(new Error("deleted")):(this.#k||this.#d)&&(this.#k&&this.#p?.(n,t,r),this.#d&&this.#s?.push([n,t,r])),this.#i.delete(t),this.#r[o]=void 0,this.#e[o]=void 0,o===this.#n)this.#n=this.#m[o];else if(o===this.#l)this.#l=this.#c[o];else{const s=this.#m[o];this.#c[s]=this.#c[o];const l=this.#c[o];this.#m[l]=this.#m[o]}this.#o--,this.#b.push(o)}}if(this.#d&&this.#s?.length){const o=this.#s;let n;for(;n=o?.shift();)this.#g?.(...n)}return i}clear(){return this.#V("delete")}#V(t){for(const r of this.#y({allowStale:!0})){const i=this.#e[r];if(this.#t(i))i.__abortController.abort(new Error("deleted"));else{const o=this.#r[r];this.#k&&this.#p?.(i,o,t),this.#d&&this.#s?.push([i,o,t])}}if(this.#i.clear(),this.#e.fill(void 0),this.#r.fill(void 0),this.#h&&this.#w&&(this.#h.fill(0),this.#w.fill(0)),this.#x&&this.#x.fill(0),this.#l=0,this.#n=0,this.#b.length=0,this.#v=0,this.#o=0,this.#d&&this.#s){const r=this.#s;let i;for(;i=r?.shift();)this.#g?.(...i)}}}const ve={hljs:`${a}-hljs`,hlcss:`${a}-hlCss`,prettier:`${a}-prettier`,prettierMD:`${a}-prettierMD`,cropperjs:`${a}-cropper`,croppercss:`${a}-cropperCss`,screenfull:`${a}-screenfull`,mermaidM:`${a}-mermaid-m`,mermaid:`${a}-mermaid`,katexjs:`${a}-katex`,katexcss:`${a}-katexCss`},Ln=(e,t)=>{const{value:r,modelValue:i,onSave:o}=e,{editorId:n}=t,[s,l]=d.useState({buildFinished:!1,html:""});d.useEffect(()=>{const c=g=>{l(()=>({buildFinished:!0,html:g}))};return E.on(n,{name:Ge,callback:c}),()=>{E.remove(n,Ge,c)}},[n]),d.useEffect(()=>{const c=()=>{if(o){const g=new Promise(f=>{if(s.buildFinished)f(s.html);else{const u=h=>{f(h),E.remove(n,Ge,u)};E.on(n,{name:Ge,callback:u})}});o(r||i||"",g)}};return E.on(n,{name:Je,callback:c}),()=>{E.remove(n,Je,c)}},[n,i,o,s.buildFinished,s.html,r]),d.useEffect(()=>{l(c=>({...c,buildFinished:!1}))},[r,i])},An=e=>{const{noPrettier:t,noUploadImg:r}=e;d.useEffect(()=>{const{editorExtensions:i,editorExtensionsAttrs:o}=re,n=t||!!i.prettier.prettierInstance,s=t||!!i.prettier.parserMarkdownInstance;if(!(r||i.cropper.instance)){const{js:l={},css:c={}}=o.cropper||{};ge("link",{...c,rel:"stylesheet",href:i.cropper.css,id:ve.croppercss}),ge("script",{...l,src:i.cropper.js,id:ve.cropperjs})}if(!n){const{standaloneJs:l={}}=o.prettier||{};ge("script",{...l,src:i.prettier.standaloneJs,id:ve.prettier})}if(!s){const{parserMarkdownJs:l={}}=o.prettier||{};ge("script",{...l,src:i.prettier.parserMarkdownJs,id:ve.prettierMD})}},[t,r])},Rn=(e,t)=>{d.useEffect(()=>(E.on(e,{name:ye,callback:t}),()=>{E.remove(e,ye,t)}),[e,t])},Mn=(e,t)=>{const{editorId:r}=t,{onUploadImg:i}=e;d.useEffect(()=>{const o=(n,s)=>{i?.(n,c=>{E.emit(r,K,"image",{desc:"",urls:c}),s?.()})};return E.on(r,{name:Qe,callback:o}),()=>{E.remove(r,Qe,o)}},[r,i])},Fn=(e,t)=>{const{editorId:r}=t,[i,o]=d.useState(!1);return d.useEffect(()=>{const n=s=>{o(s===void 0?l=>!l:s)};return E.on(r,{name:dt,callback:n}),()=>{E.remove(r,dt,n)}},[r]),i};let ai="";const Pi=e=>{const{theme:t=A.theme,preview:r=A.preview,htmlPreview:i=A.htmlPreview,pageFullscreen:o=A.pageFullscreen,previewTheme:n=A.previewTheme,codeTheme:s=A.codeTheme,language:l=A.language,codeStyleReverse:c=A.codeStyleReverse,codeStyleReverseList:g=A.codeStyleReverseList}=e,f=d.useMemo(()=>{const y=re.editorExtensions.highlight,p=re.editorExtensionsAttrs.highlight,{js:b}=y,C={...Rt,...y.css},{js:x,css:T={}}=p||{},N=c&&g.includes(n)?"dark":t,I=C[s]?C[s][N]:Rt.atom[N],j=C[s]&&T[s]?T[s][N]:T.atom?T.atom[N]:{};return{js:{src:b,...x},css:{href:I,...j}}},[c,g,n,t,s]),u=d.useMemo(()=>{const y={...Mt,...re.editorConfig.languageUserDefined};return y[l]?y[l]:Mt["zh-CN"]},[l]),[h,v]=d.useState({pageFullscreen:o,fullscreen:!1,preview:r,htmlPreview:r?!1:i,previewOnly:!1}),w=d.useRef(h),k=d.useCallback((y,p)=>{v(b=>{const C=p===void 0?!b[y]:p,x={...b};switch(y){case"preview":{x.htmlPreview=!1,x.previewOnly=!1;break}case"htmlPreview":{x.preview=!1,x.previewOnly=!1;break}case"previewOnly":{C?!x.preview&&!x.htmlPreview&&(x.preview=!0):(w.current.preview||(x.preview=!1),w.current.htmlPreview||(x.htmlPreview=!1));break}}return w.current[y]=C,x[y]=C,x})},[]);return d.useEffect(()=>{ai=document.body.style.overflow},[]),d.useEffect(()=>{h.pageFullscreen||h.fullscreen?document.body.style.overflow="hidden":document.body.style.overflow=ai},[h.pageFullscreen,h.fullscreen]),[f,u,h,k]},On=(e,t,r,i,o,n)=>{const{editorId:s}=t;d.useEffect(()=>{E.emit(s,Jr,i.pageFullscreen)},[s,i.pageFullscreen]),d.useEffect(()=>{E.emit(s,Qr,i.fullscreen)},[s,i.fullscreen]),d.useEffect(()=>{E.emit(s,ei,i.preview)},[s,i.preview]),d.useEffect(()=>{E.emit(s,ti,i.previewOnly)},[s,i.previewOnly]),d.useEffect(()=>{E.emit(s,ri,i.htmlPreview)},[s,i.htmlPreview]),d.useEffect(()=>{E.emit(s,ii,r)},[r,s]),d.useImperativeHandle(e,()=>({on(l,c){switch(l){case"pageFullscreen":{E.on(s,{name:Jr,callback(g){c(g)}});break}case"fullscreen":{E.on(s,{name:Qr,callback(g){c(g)}});break}case"preview":{E.on(s,{name:ei,callback(g){c(g)}});break}case"previewOnly":{E.on(s,{name:ti,callback(g){c(g)}});break}case"htmlPreview":{E.on(s,{name:ri,callback(g){c(g)}});break}case"catalog":{E.on(s,{name:ii,callback(g){c(g)}});break}}},togglePageFullscreen(l){o("pageFullscreen",l)},toggleFullscreen(l){E.emit(s,Tt,l)},togglePreview(l){o("preview",l)},togglePreviewOnly(l){o("previewOnly",l)},toggleHtmlPreview(l){o("htmlPreview",l)},toggleCatalog(l){E.emit(s,dt,l)},triggerSave(){E.emit(s,Je)},insert(l){E.emit(s,K,"universal",{generate:l})},focus(l){var c;(c=n.current)==null||c.focus(l)},rerender(){E.emit(s,ut)},getSelectedText(){var l;return(l=n.current)==null?void 0:l.getSelectedText()},resetHistory(){var l;(l=n.current)==null||l.resetHistory()},domEventHandlers(l){E.emit(s,Nt,l)},execCommand(l){E.emit(s,K,l)},getEditorView(){var l;return(l=n.current)==null?void 0:l.getEditorView()}}),[n,s,o])},zi=e=>{const t=d.useId();return e.id||e.editorId||a+"-"+t.replaceAll(":","")},Hn=(e,t)=>{const{editorId:r}=d.useContext(ee);d.useEffect(()=>e.noImgZoomIn?void 0:(()=>{const i=document.querySelectorAll(`#${r}-preview img:not(.not-zoom):not(.medium-zoom-image)`),o=cn(i,{background:"#00000073"});return()=>{o.detach()}})(),[r,t,e.noImgZoomIn,e.setting])},_n=(e,t,r)=>{const{editorId:i,usedLanguageText:o,customIcon:n,rootRef:s}=d.useContext(ee),{formatCopiedText:l=c=>c}=e;d.useEffect(()=>{var c;e.setting.preview&&((c=s.current)==null||c.querySelectorAll(`#${i} .${a}-preview .${a}-code`).forEach(g=>{let f=-1;const u=g.querySelector(`.${a}-copy-button`);u&&(u.onclick=h=>{h.preventDefault(),clearTimeout(f);const v=(g.querySelector("input:checked + pre code")||g.querySelector("pre code")).textContent,{text:w,successTips:k,failTips:y}=o.copyCode;let p=k;uo(l(v)).catch(()=>{p=y}).finally(()=>{u.dataset.isIcon?u.dataset.tips=p:u.innerHTML=p,f=window.setTimeout(()=>{u.dataset.isIcon?u.dataset.tips=w:u.innerHTML=w},1500)})})}))},[n,i,l,t,r,e.setting.preview,s,o.copyCode])},Dn=e=>{const{highlight:t}=d.useContext(ee),r=d.useRef(re.editorExtensions.highlight.instance),[i,o]=d.useState(!!r.current);return d.useEffect(()=>{e.noHighlight||re.editorExtensions.highlight.instance||Tn("link",{...t.css,rel:"stylesheet",id:ve.hlcss})},[t.css,e.noHighlight]),d.useEffect(()=>{e.noHighlight||r.current||ge("script",{...t.js,id:ve.hljs,onload(){r.current=window.hljs,o(!0)}},"hljs")},[]),{hljsRef:r,hljsInited:i}},at=new Ht({max:1e3,ttl:6e5}),Pn=e=>{const{editorId:t,theme:r,rootRef:i}=d.useContext(ee),{noMermaid:o,sanitizeMermaid:n}=e,s=d.useRef(re.editorExtensions.mermaid.instance),[l,c]=d.useState(-1),g=d.useCallback(()=>{at.clear();const u=s.current;!o&&u&&(u.initialize(re.mermaidConfig({startOnLoad:!1,theme:r==="dark"?"dark":"default"})),c(h=>h+1))},[o,r]);d.useEffect(g,[g]),d.useEffect(()=>{var u,h;const{editorExtensions:v,editorExtensionsAttrs:w}=re;if(o||s.current)return;const k=v.mermaid.js;/\.mjs/.test(k)?(ge("link",{...(u=w.mermaid)==null?void 0:u.js,rel:"modulepreload",href:k,id:ve.mermaidM}),import(k).then(y=>{s.current=y.default,g()})):ge("script",{...(h=w.mermaid)==null?void 0:h.js,src:k,id:ve.mermaid,onload(){s.current=window.mermaid,g()}},"mermaid")},[g,o]);const f=d.useCallback(async()=>{var u;if(!o&&s.current){const h=((u=i.current)==null?void 0:u.querySelectorAll(`div.${a}-mermaid`))||[],v=document.createElement("div"),w=document.body.offsetWidth>1366?document.body.offsetWidth:1366,k=document.body.offsetHeight>768?document.body.offsetHeight:768;v.style.width=w+"px",v.style.height=k+"px",v.style.position="fixed",v.style.zIndex="-10000",v.style.top="-10000";let y=h.length;y>0&&document.body.appendChild(v),await Promise.allSettled(Array.from(h).map(p=>(async b=>{var C;if(b.dataset.closed==="false")return!1;const x=b.innerText;let T=at.get(x);if(!T){const N=Ct();let I={svg:""};try{I=await s.current.render(N,x,v),T=await n(I.svg);const j=document.createElement("p");j.className=`${a}-mermaid`,j.setAttribute("data-processed",""),j.innerHTML=T,(C=j.children[0])==null||C.removeAttribute("height"),at.set(x,j.innerHTML),b.dataset.line!==void 0&&(j.dataset.line=b.dataset.line),b.replaceWith(j)}catch(j){E.emit(t,ye,{name:"mermaid",message:j.message,error:j})}--y===0&&v.remove()}})(p)))}},[t,o,i,n]);return{reRender:l,replaceMermaid:f}},zn=e=>{const t=d.useRef(re.editorExtensions.katex.instance),[r,i]=d.useState(!!t.current);return d.useEffect(()=>{var o,n;if(e.noKatex||t.current)return;const{editorExtensions:s,editorExtensionsAttrs:l}=re;ge("script",{...(o=l.katex)==null?void 0:o.js,src:s.katex.js,id:ve.katexjs,onload(){t.current=window.katex,i(!0)}},"katex"),ge("link",{...(n=l.katex)==null?void 0:n.css,rel:"stylesheet",href:s.katex.css,id:ve.katexcss})},[e.noKatex]),{katexRef:t,katexInited:r}},Vn=(e,t)=>{const r=e.renderer.rules.fence.bind(e.renderer.rules);e.renderer.rules.fence=(i,o,n,s,l)=>{var c;const g=i[o],f=g.content.trim();if(g.info==="mermaid"){if(g.attrSet("class",`${a}-mermaid`),g.attrSet("data-mermaid-theme",t.themeRef.current),g.map&&g.level===0){const h=g.map[1]-1,v=(c=s.srcLines[h])==null?void 0:c.trim(),w=v?.startsWith("```");g.attrSet("data-closed",w),g.attrSet("data-line",String(g.map[0]))}const u=at.get(f);return u?(g.attrSet("data-processed",""),`<p ${l.renderAttrs(g)}>${u}</p>`):`<div ${l.renderAttrs(g)}>${e.utils.escapeHtml(f)}</div>`}return r(i,o,n,s,l)}},ft=(e,t)=>{const r=e.attrs?e.attrs.slice():[];return t.forEach(i=>{const o=e.attrIndex(i[0]);o<0?r.push(i):(r[o]=r[o].slice(),r[o][1]+=` ${i[1]}`)}),r},ci={block:[{open:"$$",close:"$$"},{open:"\\[",close:"\\]"}],inline:[{open:"$$",close:"$$"},{open:"$",close:"$"},{open:"\\[",close:"\\]"},{open:"\\(",close:"\\)"}]},Wn=e=>(t,r)=>{const i=e.delimiters;let o,n,s;for(const l of i)if(t.src.startsWith(l.open,t.pos)){const c=t.pos+l.open.length;for(o=c;(o=t.src.indexOf(l.close,o))!==-1;){for(s=o-1;t.src[s]==="\\";)s-=1;if((o-s)%2===1)break;o+=l.close.length}if(o===-1)return r||(t.pending+=l.open),t.pos=c,!0;if(o-c===0)return r||(t.pending+=l.open+l.close),t.pos=c+l.close.length,!0;if(!r){const g=t.src.slice(c,o);n=t.push("math_inline","math",0),n.markup=l.open,n.content=g}return t.pos=o+l.close.length,!0}return!1},qn=e=>(t,r,i,o)=>{const n=e.delimiters;let s,l,c,g,f=!1,u=t.bMarks[r]+t.tShift[r],h=t.eMarks[r];for(const v of n)if(t.src.slice(u,u+v.open.length)===v.open&&t.src.slice(h-v.close.length,h)===v.close){if(u+=v.open.length,s=t.src.slice(u,h),o)return!0;for(s.trim().slice(-v.close.length)===v.close&&(s=s.trim().slice(0,-v.close.length),f=!0),c=r;!f&&(c++,!(c>=i||(u=t.bMarks[c]+t.tShift[c],h=t.eMarks[c],u<h&&t.tShift[c]<t.blkIndent)));)t.src.slice(u,h).trim().slice(-v.close.length)===v.close&&(g=t.src.slice(0,h).lastIndexOf(v.close),l=t.src.slice(u,g),f=!0);t.line=c+1;const w=t.push("math_block","math",0);return w.block=!0,w.content=(s&&s.trim()?s+`
`:"")+t.getLines(r+1,c,t.tShift[r],!0)+(l&&l.trim()?l:""),w.map=[r,t.line],w.markup=v.open,!0}return!1},Bn=(e,{katexRef:t,inlineDelimiters:r,blockDelimiters:i})=>{const o=(s,l,c,g,f)=>{const u=s[l],h={attrs:ft(u,[["class",`${a}-katex-inline`]])};if(t.current){const v=t.current.renderToString(u.content,re.katexConfig({throwOnError:!1}));return`<span ${f.renderAttrs(h)} data-processed>${v}</span>`}else return`<span ${f.renderAttrs(h)}>${u.content}</span>`},n=(s,l,c,g,f)=>{const u=s[l],h={attrs:ft(u,[["class",`${a}-katex-block`]])};if(t.current){const v=t.current.renderToString(u.content,re.katexConfig({throwOnError:!1,displayMode:!0}));return`<p ${f.renderAttrs(h)} data-processed>${v}</p>`}else return`<p ${f.renderAttrs(h)}>${u.content}</p>`};e.inline.ruler.before("escape","math_inline",Wn({delimiters:r||ci.inline})),e.block.ruler.after("blockquote","math_block",qn({delimiters:i||ci.block}),{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.math_inline=o,e.renderer.rules.math_block=n},Un=(e,t)=>{t=t||{};const r=3,i=t.marker||"!",o=i.charCodeAt(0),n=i.length;let s="",l="";const c=(f,u,h,v,w)=>{const k=f[u];return k.type==="admonition_open"?f[u].attrPush(["class",`${a}-admonition ${a}-admonition-${k.info}`]):k.type==="admonition_title_open"&&f[u].attrPush(["class",`${a}-admonition-title`]),w.renderToken(f,u,h)},g=f=>{const u=f.trim().split(" ",2);l="",s=u[0],u.length>1&&(l=f.substring(s.length+2))};e.block.ruler.before("code","admonition",(f,u,h,v)=>{let w,k,y,p=!1,b=f.bMarks[u]+f.tShift[u],C=f.eMarks[u];if(o!==f.src.charCodeAt(b))return!1;for(w=b+1;w<=C&&i[(w-b)%n]===f.src[w];w++);const x=Math.floor((w-b)/n);if(x!==r)return!1;w-=(w-b)%n;const T=f.src.slice(b,w),N=f.src.slice(w,C);if(g(N),v)return!0;for(k=u;k++,!(k>=h||(b=f.bMarks[k]+f.tShift[k],C=f.eMarks[k],b<C&&f.sCount[k]<f.blkIndent));)if(o===f.src.charCodeAt(b)&&!(f.sCount[k]-f.blkIndent>=4)){for(w=b+1;w<=C&&i[(w-b)%n]===f.src[w];w++);if(!(Math.floor((w-b)/n)<x)&&(w-=(w-b)%n,w=f.skipSpaces(w),!(w<C))){p=!0;break}}const I=f.parentType,j=f.lineMax;return f.parentType="root",f.lineMax=k,y=f.push("admonition_open","div",1),y.markup=T,y.block=!0,y.info=s,y.map=[u,k],l&&(y=f.push("admonition_title_open","p",1),y.markup=T+" "+s,y.map=[u,k],y=f.push("inline","",0),y.content=l,y.map=[u,f.line-1],y.children=[],y=f.push("admonition_title_close","p",-1),y.markup=T+" "+s),f.md.block.tokenize(f,u+1,k),y=f.push("admonition_close","div",-1),y.markup=f.src.slice(b,w),y.block=!0,f.parentType=I,f.lineMax=j,f.line=k+(p?1:0),!0},{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.admonition_open=c,e.renderer.rules.admonition_title_open=c,e.renderer.rules.admonition_title_close=c,e.renderer.rules.admonition_close=c},Kn=(e,t)=>{e.renderer.rules.heading_open=(r,i)=>{var o;const n=r[i],s=((o=r[i+1].children)==null?void 0:o.reduce((c,g)=>c+(["text","code_inline","math_inline"].includes(g.type)&&g.content||""),""))||"",l=n.markup.length;return t.headsRef.current.push({text:s,level:l,line:n.map[0]}),n.map&&n.level===0&&n.attrSet("id",t.mdHeadingId(s,l,t.headsRef.current.length)),e.renderer.renderToken(r,i,t)},e.renderer.rules.heading_close=(r,i,o,n,s)=>s.renderToken(r,i,o)},Gn=(e,t)=>{const r=e.renderer.rules.fence,i=e.utils.unescapeAll,o=/\[(\w*)(?::([\w ]*))?\]/,n=/::(open|close)/,s=u=>u.info?i(u.info).trim():"",l=u=>{const h=s(u),[v=null,w=""]=(o.exec(h)||[]).slice(1);return[v,w]},c=u=>{const h=s(u);return h?h.split(/(\s+)/g)[0]:""},g=u=>{const h=u.info.match(n)||[],v=h[1]==="open"||h[1]!=="close"&&t.codeFoldable&&u.content.trim().split(`
`).length<t.autoFoldThreshold,w=h[1]||t.codeFoldable?"details":"div",k=h[1]||t.codeFoldable?"summary":"div";return{open:v,tagContainer:w,tagHeader:k}},f=(u,h,v,w,k)=>{if(u[h].hidden)return"";const y=t.usedLanguageTextRef.current.copyCode.text,p=t.customIconRef.current.copy||y,b=!!t.customIconRef.current.copy,C=`<span class="${a}-collapse-tips">${st("collapse-tips",t.customIconRef.current)}</span>`,[x]=l(u[h]);if(x===null){const{open:q,tagContainer:V,tagHeader:ie}=g(u[h]),W=[["class",`${a}-code`]];q&&W.push(["open",""]);const se={attrs:ft(u[h],W)};u[h].info=u[h].info.replace(n,"");const J=r(u,h,v,w,k);return`
        <${V} ${k.renderAttrs(se)}>
          <${ie} class="${a}-code-head">
            <div class="${a}-code-flag"><span></span><span></span><span></span></div>
            <div class="${a}-code-action">
              <span class="${a}-code-lang">${e.utils.escapeHtml(u[h].info.trim())}</span>
              <span class="${a}-copy-button" data-tips="${y}"${b?" data-is-icon=true":""}>${p}</span>
              ${t.extraTools instanceof Function?t.extraTools({lang:u[h].info.trim()}):t.extraTools||""}
              ${V==="details"?C:""}
            </div>
          </${ie}>
          ${J}
        </${V}>
      `}let T,N,I,j,L="",O="",F="";const{open:_,tagContainer:M,tagHeader:H}=g(u[h]),G=[["class",`${a}-code`]];_&&G.push(["open",""]);const Z={attrs:ft(u[h],G)};for(let q=h;q<u.length&&(T=u[q],[N,I]=l(T),N===x);q++){T.info=T.info.replace(o,"").replace(n,""),T.hidden=!0;const V=`${a}-codetab-${t.editorId}-${h}-${q-h}`;j=q-h>0?"":"checked",L+=`
        <li>
          <input
            type="radio"
            id="label-${a}-codetab-label-1-${t.editorId}-${h}-${q-h}"
            name="${a}-codetab-label-${t.editorId}-${h}"
            class="${V}"
            ${j}
          >
          <label
            for="label-${a}-codetab-label-1-${t.editorId}-${h}-${q-h}"
            onclick="this.getRootNode().querySelectorAll('.${V}').forEach(e => e.click())"
          >
            ${e.utils.escapeHtml(I||c(T))}
          </label>
        </li>`,O+=`
        <div role="tabpanel">
          <input
            type="radio"
            name="${a}-codetab-pre-${t.editorId}-${h}"
            class="${V}"
            ${j}
            role="presentation">
          ${r(u,q,v,w,k)}
        </div>`,F+=`
        <input
          type="radio"
          name="${a}-codetab-lang-${t.editorId}-${h}"
          class="${V}"
          ${j}
          role="presentation">
        <span class=${a}-code-lang role="note">${e.utils.escapeHtml(c(T))}</span>`}return`
      <${M} ${k.renderAttrs(Z)}>
        <${H} class="${a}-code-head">
          <div class="${a}-code-flag">
            <ul class="${a}-codetab-label" role="tablist">${L}</ul>
          </div>
          <div class="${a}-code-action">
            <span class="${a}-codetab-lang">${F}</span>
            <span class="${a}-copy-button" data-tips="${y}"${b?" data-is-icon=true":""}>${p}</span>
            ${t.extraTools instanceof Function?t.extraTools({lang:u[h].info.trim()}):t.extraTools||""}
            ${M==="details"?C:""}
          </div>
        </${H}>
        ${O}
      </${M}>
    `};e.renderer.rules.fence=f,e.renderer.rules.code_block=f},di=(e,t,r)=>{const i=e.attrIndex(t),o=[t,r];i<0?e.attrPush(o):(e.attrs=e.attrs||[],e.attrs[i]=o)},Zn=e=>e.type==="inline",Xn=e=>e.type==="paragraph_open",Yn=e=>e.type==="list_item_open",Jn=e=>e.content.indexOf("[ ] ")===0||e.content.indexOf("[x] ")===0||e.content.indexOf("[X] ")===0,Qn=(e,t)=>Zn(e[t])&&Xn(e[t-1])&&Yn(e[t-2])&&Jn(e[t]),es=(e,t)=>{const r=e[t].level-1;for(let i=t-1;i>=0;i--)if(e[i].level===r)return i;return-1},ts=e=>{const t=new e("html_inline","",0);return t.content="<label>",t},rs=e=>{const t=new e("html_inline","",0);return t.content="</label>",t},is=(e,t,r)=>{const i=new r("html_inline","",0);return i.content='<label class="task-list-item-label" for="'+t+'">'+e+"</label>",i.attrs=[{for:t}],i},os=(e,t,r)=>{const i=new t("html_inline","",0),o=r.enabled?" ":' disabled="" ';return e.content.indexOf("[ ] ")===0?i.content='<input class="task-list-item-checkbox"'+o+'type="checkbox">':(e.content.indexOf("[x] ")===0||e.content.indexOf("[X] ")===0)&&(i.content='<input class="task-list-item-checkbox" checked=""'+o+'type="checkbox">'),i},ns=(e,t,r)=>{if(e.children=e.children||[],e.children.unshift(os(e,t,r)),e.children[1].content=e.children[1].content.slice(3),e.content=e.content.slice(3),r.label)if(r.labelAfter){e.children.pop();const i="task-item-"+Math.ceil(Math.random()*(1e4*1e3)-1e3);e.children[0].content=e.children[0].content.slice(0,-1)+' id="'+i+'">',e.children.push(is(e.content,i,t))}else e.children.unshift(ts(t)),e.children.push(rs(t))},ss=(e,t={})=>{e.core.ruler.after("inline","github-task-lists",r=>{const i=r.tokens;for(let o=2;o<i.length;o++)Qn(i,o)&&(ns(i[o],r.Token,t),di(i[o-2],"class","task-list-item"+(t.enabled?" enabled":" ")),di(i[es(i,o-2)],"class","contains-task-list"))})},ls=e=>{e.core.ruler.push("init-line-number",t=>(t.tokens.forEach(r=>{r.map&&(r.attrs||(r.attrs=[]),r.attrs.push(["data-line",r.map[0].toString()]))}),!0))},as=(e,t)=>{var r,i;const{modelValue:o,sanitize:n,mdHeadingId:s,codeFoldable:l,autoFoldThreshold:c,noKatex:g,noMermaid:f,noHighlight:u,setting:h,onHtmlChanged:v,onGetCatalog:w}=e,{editorConfig:k,markdownItPlugins:y,editorExtensions:p}=re,{editorId:b,language:C,showCodeRowNumber:x,theme:T,usedLanguageText:N,customIcon:I,rootRef:j}=d.useContext(ee),L=d.useRef([]),O=d.useRef(T);d.useEffect(()=>{O.current=T},[T]);const F=d.useRef(N);d.useEffect(()=>{F.current=N},[N]);const _=d.useRef(I);d.useEffect(()=>{_.current=I},[I]);const{hljsRef:M,hljsInited:H}=Dn(e),{katexRef:G,katexInited:Z}=zn(e),{reRender:q,replaceMermaid:V}=Pn(e),[ie]=d.useState(()=>{const B=dn({html:!0,breaks:!0,linkify:!0}),de=[{type:"image",plugin:un,options:{figcaption:!0,classes:"md-zoom"}},{type:"admonition",plugin:Un,options:{}},{type:"taskList",plugin:ss,options:{}},{type:"heading",plugin:Kn,options:{mdHeadingId:s,headsRef:L}},{type:"code",plugin:Gn,options:{editorId:b,usedLanguageTextRef:F,codeFoldable:l,autoFoldThreshold:c,customIconRef:_}},{type:"sub",plugin:mn,options:{}},{type:"sup",plugin:hn,options:{}}];g||de.push({type:"katex",plugin:Bn,options:{katexRef:G}}),f||de.push({type:"mermaid",plugin:Vn,options:{themeRef:O}}),y(de,{editorId:b}).forEach(ue=>{B.use(ue.plugin,ue.options)});const ne=B.options.highlight;return B.set({highlight:(ue,be,Fe)=>{if(ne){const Ae=ne(ue,be,Fe);if(Ae)return Ae}let Ce;!u&&M.current?M.current.getLanguage(be)?Ce=M.current.highlight(ue,{language:be,ignoreIllegals:!0}).value:Ce=M.current.highlightAuto(ue).value:Ce=ie.utils.escapeHtml(ue);const et=x?jn(Ce.replace(/^\n+|\n+$/g,""),ue.replace(/^\n+|\n+$/g,"")):`<span class="${a}-code-block">${Ce.replace(/^\n+|\n+$/g,"")}</span>`;return`<pre><code class="language-${be}" language=${be}>${et}</code></pre>`}}),ls(B),B}),[W,se]=d.useState(`_article-key_${Ct()}`),[J,X]=d.useState(()=>(L.current=[],n(ie.render(o,{srcLines:o.split(`
`)})))),oe=d.useMemo(()=>(u||H)&&(g||Z),[H,Z,u,g]),Le=d.useRef(!0),pe=d.useCallback(()=>{L.current=[];const B=n(ie.render(o,{srcLines:o.split(`
`)}));X(B)},[ie,o,n]);return d.useEffect(()=>{E.emit(b,Ge,J),v?.(J),w?.(L.current),E.emit(b,Ye,L.current)},[b,J,W,w,v]),d.useEffect(()=>{let B=()=>{};return h.preview&&(V().then(()=>{var de,ne;(de=p.mermaid)!=null&&de.enableZoom&&(B(),B=ni((ne=j.current)==null?void 0:ne.querySelectorAll(`#${b} .${a}-mermaid:not([data-closed=false])`),{customIcon:_.current}))}),E.emit(b,Ye,L.current)),()=>{B()}},[(r=p.mermaid)==null?void 0:r.enableZoom,b,V,j,h.preview]),d.useEffect(()=>{if(Le.current){Le.current=!1;return}const B=setTimeout(()=>{pe()},t?0:k.renderDelay);return()=>{clearTimeout(B)}},[oe,T,pe,C,t,k.renderDelay]),d.useEffect(()=>{let B=()=>{};return V().then(()=>{var de,ne;(de=p.mermaid)!=null&&de.enableZoom&&(B(),B=ni((ne=j.current)==null?void 0:ne.querySelectorAll(`#${b} p.${a}-mermaid:not([data-closed=false])`),{customIcon:_.current}))}),()=>{B()}},[(i=p.mermaid)==null?void 0:i.enableZoom,b,J,W,q,V,j]),d.useEffect(()=>{const B=()=>{E.emit(b,Ye,L.current)};return E.on(b,{name:It,callback:B}),()=>{E.remove(b,It,B)}},[b]),d.useEffect(()=>{const B=()=>{se(`_article-key_${Ct()}`),pe()};return E.on(b,{name:ut,callback:B}),()=>{E.remove(b,ut,B)}},[b,pe]),{html:J,key:W}},ui={checked:{regexp:/- \[x\]/,value:"- [ ]"},unChecked:{regexp:/- \[\s\]/,value:"- [x]"}},cs=(e,t)=>{const{editorId:r,rootRef:i}=d.useContext(ee);d.useEffect(()=>{var o;const n=((o=i.current)==null?void 0:o.querySelectorAll(".task-list-item.enabled"))||[],s=l=>{var c;l.preventDefault();const g=l.target.checked?"unChecked":"checked",f=(c=l.target.parentElement)==null?void 0:c.dataset.line;if(!f)return;const u=Number(f),h=e.modelValue.split(`
`),v=h[Number(u)].replace(ui[g].regexp,ui[g].value);e.previewOnly?(h[Number(u)]=v,e.onChange(h.join(`
`))):E.emit(r,Lt,u+1,v)};return n.forEach(l=>{l.addEventListener("click",s)}),()=>{n.forEach(l=>{l.removeEventListener("click",s)})}},[r,t,e,i])},ds=(e,t,r)=>{const{setting:i,onRemount:o}=e;d.useEffect(()=>{o?.()},[t,r,o]),d.useEffect(()=>{(i.preview||i.htmlPreview)&&o?.()},[i.preview,i.htmlPreview,o])},us=e=>{const t=new DOMParser().parseFromString(e,"text/html");return Array.from(t.body.childNodes)},ms=(e,t)=>{const r=[],i=[];if(e.forEach((o,n)=>{const s=t[n];if(!s){r.push({index:n,newNode:o});return}(o.nodeType!==s.nodeType||o.textContent!==s.textContent||o.nodeType===1&&o.outerHTML!==s.outerHTML)&&r.push({index:n,newNode:o})}),t.length>e.length)for(let o=e.length;o<t.length;o++)i.push(t[o]);return{updates:r,deletes:i}},hs=({html:e})=>{const{editorId:t,previewTheme:r,showCodeRowNumber:i}=d.useContext(ee),o=d.useRef({__html:e}),n=d.useRef(null);return d.useEffect(()=>{if(!n.current)return;const s=us(e),l=Array.from(n.current.childNodes||[]),{updates:c,deletes:g}=ms(s,l);g.forEach(f=>{f.remove()}),c.forEach(({index:f,newNode:u})=>{const h=n.current.childNodes[f];h?n.current.replaceChild(u.cloneNode(!0),h):n.current.appendChild(u.cloneNode(!0))})},[e]),m.jsx("div",{id:`${t}-preview`,className:P([`${a}-preview`,`${r}-theme`,i&&`${a}-scrn`]),dangerouslySetInnerHTML:o.current,ref:n})},Vi=e=>{const{previewOnly:t=!1}=e,{editorId:r}=d.useContext(ee),{html:i,key:o}=as(e,!!t);return _n(e,i,o),Hn(e,i),cs(e,i),ds(e,i,o),m.jsxs(m.Fragment,{children:[e.setting.preview&&m.jsx("div",{id:`${r}-preview-wrapper`,className:`${a}-preview-wrapper`,children:m.jsx(hs,{html:i},o)},"content-preview-wrapper"),!t&&e.setting.htmlPreview&&m.jsx("div",{id:`${r}-html-wrapper`,className:`${a}-preview-wrapper`,children:m.jsx("div",{className:`${a}-html`,children:i})},"html-preview-wrapper")]})},mi=`${a}-dropdown-hidden`,Ue=e=>{const{relative:t="html",onChange:r,disabled:i}=e,[o,n]=d.useState({overlayClass:mi,overlayStyle:{}}),s=d.useRef({triggerHover:!1,overlayHover:!1}),l=d.useRef(null),c=d.useRef(null),g=d.useCallback(()=>{var p,b;if(i)return!1;s.current.triggerHover=!0;const C=l.current,x=c.current;if(!C||!x)return;const T=C.getBoundingClientRect(),N=C.offsetTop,I=C.offsetLeft,j=T.height,L=T.width,O=C.getRootNode(),F=((p=O.querySelector(t))==null?void 0:p.scrollLeft)||0,_=((b=O.querySelector(t))==null?void 0:b.clientWidth)||0;let M=I-x.offsetWidth/2+L/2-F;M+x.offsetWidth>F+_&&(M=F+_-x.offsetWidth),M<0&&(M=0),n(H=>({...H,overlayStyle:{top:N+j+"px",left:M+"px"}})),r(!0)},[i,r,t]),f=d.useCallback(()=>{if(i)return!1;s.current.overlayHover=!0},[i]),u=d.useRef(-1),h=d.useCallback(p=>{var b;if(i)return!1;(b=l.current)!=null&&b.contains(p.target)?s.current.triggerHover=!1:s.current.overlayHover=!1,clearTimeout(u.current),u.current=window.setTimeout(()=>{!s.current.overlayHover&&!s.current.triggerHover&&r(!1)},10)},[i,r]),v=e.children,w=e.overlay,k=d.cloneElement(v,{ref:l,key:"cloned-dropdown-trigger"});d.useEffect(()=>{e.visible?n(p=>({...p,overlayClass:""})):n(p=>({...p,overlayClass:mi}))},[e.visible]),d.useEffect(()=>{const p=l.current,b=c.current;return p?.addEventListener("mouseenter",g),p?.addEventListener("mouseleave",h),b?.addEventListener("mouseenter",f),b?.addEventListener("mouseleave",h),()=>{p?.removeEventListener("mouseenter",g),p?.removeEventListener("mouseleave",h),b?.removeEventListener("mouseenter",f),b?.removeEventListener("mouseleave",h)}},[h,f,g]);const y=m.jsx("div",{className:`${a}-dropdown ${o.overlayClass}`,style:o.overlayStyle,ref:c,children:m.jsx("div",{className:`${a}-dropdown-overlay`,children:w instanceof Array?w[0]:w})});return m.jsxs(m.Fragment,{children:[k,y]})},fs=e=>m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`lucide lucide-github-icon ${e.className}`,children:[m.jsx("path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"}),m.jsx("path",{d:"M9 18c-4.51 2-5-2-7-2"})]}),ps={bold:Uo,underline:Bo,italic:qo,"strike-through":Wo,title:Vo,sub:zo,sup:Po,quote:Do,"unordered-list":_o,"ordered-list":Ho,task:Oo,"code-row":Fo,code:Xr,link:Mo,image:Ro,table:Ao,revoke:Lo,next:No,save:Io,prettier:Xr,minimize:jo,maximize:So,"fullscreen-exit":Eo,fullscreen:To,"preview-only":Co,preview:yo,"preview-html":$o,catalog:ko,github:fs,mermaid:wo,formula:xo,close:bo,delete:vo,upload:go},gs=e=>d.createElement(ps[e.name],{className:`${a}-icon`}),z=e=>{const{customIcon:t}=d.useContext(ee),r=t[e.name];if(typeof r=="object"){const i=r.component;return typeof i=="function"?m.jsx(i,{...r.props}):m.jsx("span",{dangerouslySetInnerHTML:{__html:r.component}})}return m.jsx(gs,{name:e.name})},vs=`${a}-modal-container`,Wi=e=>{const{theme:t,rootRef:r}=d.useContext(ee),{onClose:i=()=>{},onAdjust:o=()=>{},style:n={},showMask:s=!0}=e,[l,c]=d.useState(e.visible),[g,f]=d.useState([`${a}-modal`]),u=d.useRef(null),h=d.useRef(null),v=d.useRef(),w=d.useRef(null),[k,y]=d.useState({maskStyle:{zIndex:-1},modalStyle:{zIndex:-1},initPos:{left:"0px",top:"0px"},historyPos:{left:"0px",top:"0px"}}),p=d.useMemo(()=>e.isFullscreen?{width:"100%",height:"100%"}:{width:e.width,height:e.height},[e.height,e.isFullscreen,e.width]);return d.useEffect(()=>{var b;const C=(b=r.current)==null?void 0:b.getRootNode();return v.current=C instanceof Document?document.body:C,()=>{v.current=void 0}},[r]),d.useEffect(()=>{let b=()=>{};return!e.isFullscreen&&e.visible&&(b=Cn(h.current,(C,x)=>{y(T=>({...T,initPos:{left:C+"px",top:x+"px"}}))})),b},[e.isFullscreen,e.visible]),d.useEffect(()=>{if(l){const b=u.current.offsetWidth/2,C=u.current.offsetHeight/2,x=document.documentElement.clientWidth/2,T=document.documentElement.clientHeight/2;y(N=>({...N,maskStyle:{zIndex:re.editorConfig.zIndex+si()},modalStyle:{zIndex:re.editorConfig.zIndex+si()},initPos:{left:x-b+"px",top:T-C+"px"}}))}},[l]),d.useEffect(()=>{const b=e.visible;b?(f(()=>[`${a}-modal`,"zoom-in"]),c(b)):(f(()=>[`${a}-modal`,"zoom-out"]),setTimeout(()=>{c(b)},150))},[e.visible]),m.jsx(m.Fragment,{children:v.current&&po.createPortal(m.jsx("div",{ref:w,className:vs,"data-theme":t,children:m.jsxs("div",{className:e.className,style:{...n,display:l?"block":"none"},children:[s&&m.jsx("div",{className:`${a}-modal-mask`,style:k.maskStyle,onClick:i}),m.jsxs("div",{className:g.join(" "),style:{...k.modalStyle,...k.initPos,...p},ref:u,children:[m.jsx("div",{className:`${a}-modal-header`,ref:h,children:e.title||""}),m.jsxs("div",{className:`${a}-modal-func`,children:[e.showAdjust&&m.jsx("div",{className:`${a}-modal-adjust`,onClick:b=>{b.stopPropagation(),e.isFullscreen?y(C=>({...C,initPos:C.historyPos})):y(C=>({...C,historyPos:C.initPos,initPos:{left:"0",top:"0"}})),o instanceof Function&&o(!e.isFullscreen)},children:m.jsx(z,{name:e.isFullscreen?"minimize":"maximize"})}),m.jsx("div",{className:`${a}-modal-close`,onClick:b=>{b.stopPropagation(),e.onClose&&e.onClose()},children:m.jsx(z,{name:"close"})})]}),m.jsx("div",{className:`${a}-modal-body`,children:e.children})]})]})}),v.current)})},bs=`.${a}-preview > [data-line]`,Pe=(e,t)=>+getComputedStyle(e).getPropertyValue(t).replace("px",""),xs=(e,t)=>{const r=mo(()=>{e.removeEventListener("scroll",i),e.addEventListener("scroll",i),t.removeEventListener("scroll",i),t.addEventListener("scroll",i)},50),i=o=>{const n=e.clientHeight,s=t.clientHeight,l=e.scrollHeight,c=t.scrollHeight,g=(l-n)/(c-s);o.target===e?(t.removeEventListener("scroll",i),t.scrollTo({top:e.scrollTop/g}),r()):(e.removeEventListener("scroll",i),e.scrollTo({top:t.scrollTop*g}),r())};return[()=>{r().finally(()=>{e.dispatchEvent(new Event("scroll"))})},()=>{e.removeEventListener("scroll",i),t.removeEventListener("scroll",i)}]},ws=(e,t,r)=>{const{view:i}=r,o=Ai(),n=p=>i.lineBlockAt(i.state.doc.line(p+1).from).top,s=p=>i.lineBlockAt(i.state.doc.line(p+1).from).bottom;let l=[],c=[],g=[];const f=()=>{l=[],c=Array.from(t.querySelectorAll(bs)),g=c.map(T=>Number(T.dataset.line));const p=[...g],{lines:b}=i.state.doc;let C=p.shift()||0,x=p.shift()||b;for(let T=0;T<b;T++)T===x&&(C=T,x=p.shift()||b),l.push({start:C,end:x-1})},u=(p,b)=>{let C=1;for(let x=c.length-1;x-1>=0;x--){const T=c[x],N=c[x-1];if(T.offsetTop+T.offsetHeight>b&&N.offsetTop<b){C=Number(N.dataset.line);break}}for(let x=l.length-1;x>=0;x--){const T=s(l[x].end),N=n(l[x].start);if(T>p&&N<=p){C=C<l[x].start?C:l[x].start;break}}return C};let h=0,v=0;const w=()=>{var p,b,C;if(v!==0)return!1;h++;const{scrollDOM:x,contentHeight:T}=i;let N=Pe(t,"padding-top");const I=i.lineBlockAtHeight(x.scrollTop),{number:j}=i.state.doc.lineAt(I.from),L=l[j-1];if(!L)return!1;let O=1;const F=t.querySelector(`[data-line="${L.start}"]`)||((p=t.firstElementChild)==null?void 0:p.firstElementChild),_=t.querySelector(`[data-line="${L.end+1}"]`)||((b=t.lastElementChild)==null?void 0:b.lastElementChild),M=x.scrollHeight-x.clientHeight,H=t.scrollHeight-t.clientHeight;let G=n(L.start),Z=s(L.end),q=F.offsetTop,V=_.offsetTop-q;G===0&&(q=0,F===_?(N=0,Z=T-x.offsetHeight,V=H):V=_.offsetTop),O=(x.scrollTop-G)/(Z-G);const ie=_==((C=t.lastElementChild)==null?void 0:C.lastElementChild)?_.offsetTop+_.clientHeight:_.offsetTop;if(Z>=M||ie>H){const se=u(M,H);G=n(se),O=(x.scrollTop-G)/(M-G);const J=t.querySelector(`[data-line="${se}"]`);G>0&&J&&(q=J.offsetTop),V=H-q+Pe(t,"padding-top")}const W=q-N+V*O;o(t,W,()=>{h--})},k=()=>{var p,b,C,x,T,N;if(h!==0)return;v++;const{scrollDOM:I}=i,j=t.scrollTop,L=t.scrollHeight,O=I.scrollHeight-I.clientHeight,F=t.scrollHeight-t.clientHeight;let _=(p=t.firstElementChild)==null?void 0:p.firstElementChild,M=(b=t.firstElementChild)==null?void 0:b.lastElementChild;if(g.length>0){let J=Math.ceil(g[g.length-1]*(j/L)),X=g.findLastIndex(oe=>oe<=J);X=X===-1?0:X,J=g[X];for(let oe=X;oe>=0&&oe<g.length;)if(c[oe].offsetTop>j){if(oe-1>=0){oe--;continue}J=-1,X=oe;break}else{if(oe+1<g.length&&c[oe+1].offsetTop<j){oe++;continue}J=g[oe],X=oe;break}switch(X){case-1:{_=(C=t.firstElementChild)==null?void 0:C.firstElementChild,M=c[X];break}case g.length-1:{_=c[X],M=(x=t.firstElementChild)==null?void 0:x.lastElementChild;break}default:_=c[X],M=c[X+1===c.length?X:X+1]}}let H=_===((T=t.firstElementChild)==null?void 0:T.firstElementChild)?0:_.offsetTop-Pe(_,"margin-top"),G=M.offsetTop,Z=0;const{start:q,end:V}=l[Number(_.dataset.line||0)];let ie=n(q);const W=n(V+1===i.state.doc.lines?V:V+1);let se=0;if(W>O||M.offsetTop+M.offsetHeight>F){const J=u(O,F),X=t.querySelector(`[data-line="${J}"]`);H=X?X.offsetTop-Pe(X,"margin-top"):H,ie=n(J),Z=(j-H)/(F-H),se=O-ie}else _===((N=t.firstElementChild)==null?void 0:N.firstElementChild)?(_===M&&(G=M.offsetTop+M.offsetHeight+ +getComputedStyle(M).marginBottom.replace("px","")),se=W,Z=Math.max(j/G,0)):(Z=Math.max((j-H)/(G-H),0),se=W-ie);o(e,ie+se*Z,()=>{v--})},y=p=>{var b;const{scrollDOM:C,contentHeight:x}=i,T=C.clientHeight;if(x<=T||t.firstElementChild.clientHeight<=t.clientHeight||i.state.doc.lines<=((b=l[l.length-1])==null?void 0:b.end))return!1;p.target===e?w():k()};return[()=>{f(),e.addEventListener("scroll",y),t.addEventListener("scroll",y),e.dispatchEvent(new Event("scroll"))},()=>{e.removeEventListener("scroll",y),t.removeEventListener("scroll",y)}]},qi=d.createContext({scrollElementRef:void 0,rootNodeRef:void 0}),Bi=({tocItem:e,mdHeadingId:t,onActive:r,onClick:i,scrollElementOffsetTop:o=0})=>{const{scrollElementRef:n,rootNodeRef:s}=d.useContext(qi),l=d.useRef(null);return d.useEffect(()=>{e.active&&r(e,l.current)},[r,e,e.active]),m.jsxs("div",{ref:l,className:P([`${a}-catalog-link`,e.active&&`${a}-catalog-active`]),onClick:c=>{if(c.stopPropagation(),i?.(c,e),c.defaultPrevented)return;const g=t(e.text,e.level,e.index),f=s?.current.getElementById(g),u=n?.current;if(f&&u){let h=f.offsetParent,v=f.offsetTop;if(u.contains(h))for(;h&&u!=h;)v+=h?.offsetTop,h=h?.offsetParent;const w=f.previousElementSibling;let k=0;w||(k=Pe(f,"margin-top")),u?.scrollTo({top:v-o-k,behavior:"smooth"})}},children:[m.jsx("span",{title:e.text,children:e.text}),e.children&&e.children.length>0&&m.jsx("div",{className:`${a}-catalog-wrapper`,children:e.children.map(c=>m.jsx(Bi,{mdHeadingId:t,tocItem:c,onActive:r,onClick:i,scrollElementOffsetTop:o},`${e.text}-link-${c.level}-${c.text}`))})]})},ks=e=>{const{editorId:t,mdHeadingId:r=A.mdHeadingId,theme:i="light",offsetTop:o=20,syncWith:n="preview"}=e,s=d.useMemo(()=>`#${t}-preview-wrapper`,[t]),[l,c]=d.useState([]),[g,f]=d.useState(),u=d.useRef(null),h=d.useRef(),v=d.useRef(),w=d.useRef(),[k,y]=d.useState(),[p,b]=d.useState({}),C=d.useMemo(()=>{const I=[];return l.forEach((j,L)=>{if(e.catalogMaxDepth&&j.level>e.catalogMaxDepth)return;const{text:O,level:F,line:_}=j,M={level:F,text:O,line:_,index:L+1,active:g===j};if(I.length===0)I.push(M);else{let H=I[I.length-1];if(M.level>H.level)for(let G=H.level+1;G<=6;G++){const{children:Z}=H;if(!Z){H.children=[M];break}if(H=Z[Z.length-1],M.level<=H.level){Z.push(M);break}}else I.push(M)}}),I},[g,l,e.catalogMaxDepth]),[x]=d.useState(()=>e.scrollElement||`#${t}-preview-wrapper`),T=d.useCallback(()=>{var I;if(x instanceof HTMLElement)return x;let j=document;return(x===s||e.isScrollElementInShadow)&&(j=(I=u.current)==null?void 0:I.getRootNode()),j.querySelector(x)},[s,e.isScrollElementInShadow,x]),N=d.useCallback((I,j)=>{var L;b({top:j.offsetTop+Pe(j,"padding-top")+"px"}),(L=e.onActive)==null||L.call(e,I,j)},[e]);return d.useEffect(()=>{w.current=u.current.getRootNode()},[]),d.useEffect(()=>{let I=[];const j=F=>{if(F.length===0)return f(void 0),c([]),I=F,!1;const{activeHead:_}=F.reduce((M,H,G)=>{var Z;let q=0;if(n==="preview"){const V=(Z=w.current)==null?void 0:Z.getElementById(r(H.text,H.level,G+1));V instanceof HTMLElement&&(q=In(V,h.current))}else if(k){const V=k.lineBlockAt(k.state.doc.line(H.line+1).from).top,ie=k.scrollDOM.scrollTop;q=V-ie}return q<o&&q>M.minTop?{activeHead:H,minTop:q}:M},{activeHead:F[0],minTop:Number.MIN_SAFE_INTEGER});f(_),c(F),I=F},L=()=>{j(I)},O=F=>{var _,M;if((_=v.current)==null||_.removeEventListener("scroll",L),n==="editor")v.current=k?.scrollDOM;else{const H=T();h.current=H,v.current=H===document.documentElement?document:H}j(F),(M=v.current)==null||M.addEventListener("scroll",L)};return E.on(t,{name:Ye,callback:O}),E.emit(t,It),()=>{var F;E.remove(t,Ye,O),(F=v.current)==null||F.removeEventListener("scroll",L)}},[o,r,T,t,n,k]),d.useEffect(()=>{const I=j=>{y(j)};return E.on(t,{name:mt,callback:I}),E.emit(t,At),()=>{E.remove(t,mt,I)}},[t]),m.jsx(qi.Provider,{value:{scrollElementRef:h,rootNodeRef:w},children:m.jsx("div",{className:P([`${a}-catalog`,i==="dark"&&`${a}-catalog-dark`,e.className||""]),style:e.style,ref:u,children:C.length>0&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:`${a}-catalog-indicator`,style:p}),m.jsx("div",{className:`${a}-catalog-container`,children:C.map(I=>m.jsx(Bi,{mdHeadingId:r,tocItem:I,onActive:N,onClick:e.onClick,scrollElementOffsetTop:e.scrollElementOffsetTop},`link-${I.level}-${I.text}`))})]})})})},$s=d.memo(ks);var ys=Object.defineProperty,Cs=(e,t,r)=>t in e?ys(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Se=(e,t,r)=>Cs(e,typeof t!="symbol"?t+"":t,r);const Ts=()=>m.jsx("div",{className:`${a}-divider`}),Es=e=>{var t,r,i,o,n;const{editorId:s,usedLanguageText:l}=d.useContext(ee),c=d.useMemo(()=>{var u,h;switch(e.type){case"link":return(u=l.linkModalTips)==null?void 0:u.linkTitle;case"image":return(h=l.linkModalTips)==null?void 0:h.imageTitle;default:return""}},[e.type,l]),[g,f]=d.useState({desc:"",url:""});return d.useEffect(()=>{e.visible||setTimeout(()=>{f({desc:"",url:""})},200)},[e.visible]),d.useMemo(()=>{var u,h,v,w,k;return m.jsxs(Wi,{title:c,visible:e.visible,onClose:e.onCancel,children:[m.jsxs("div",{className:`${a}-form-item`,children:[m.jsx("label",{className:`${a}-label`,htmlFor:`link-desc-${s}`,children:(u=l.linkModalTips)==null?void 0:u.descLabel}),m.jsx("input",{placeholder:(h=l.linkModalTips)==null?void 0:h.descLabelPlaceHolder,className:`${a}-input`,id:`link-desc-${s}`,type:"text",value:g.desc,onChange:y=>{f(p=>({...p,desc:y.target.value}))}})]}),m.jsxs("div",{className:`${a}-form-item`,children:[m.jsx("label",{className:`${a}-label`,htmlFor:`link-url-${s}`,children:(v=l.linkModalTips)==null?void 0:v.urlLabel}),m.jsx("input",{placeholder:(w=l.linkModalTips)==null?void 0:w.urlLabelPlaceHolder,className:`${a}-input`,id:`link-url-${s}`,type:"text",value:g.url,onChange:y=>{f(p=>({...p,url:y.target.value}))}})]}),m.jsx("div",{className:`${a}-form-item`,children:m.jsx("button",{className:`${a}-btn ${a}-btn-row`,type:"button",onClick:()=>{e.onOk(g),f(y=>({...y,desc:"",url:""}))},children:(k=l.linkModalTips)==null?void 0:k.buttonOK})})]})},[c,e,s,(t=l.linkModalTips)==null?void 0:t.descLabel,(r=l.linkModalTips)==null?void 0:r.descLabelPlaceHolder,(i=l.linkModalTips)==null?void 0:i.urlLabel,(o=l.linkModalTips)==null?void 0:o.urlLabelPlaceHolder,(n=l.linkModalTips)==null?void 0:n.buttonOK,g])};let je=null;const Ss=e=>{var t,r,i;const o=d.useContext(ee),{editorId:n,usedLanguageText:s,rootRef:l}=o,c=re.editorExtensions.cropper.instance,g=d.useRef(null),f=d.useRef(null),u=d.useRef(null),[h,v]=d.useState({cropperInited:!1,imgSelected:!1,imgSrc:"",isFullscreen:!1});d.useEffect(()=>{e.visible&&!h.cropperInited&&(window.Cropper=c||window.Cropper,g.current.onchange=()=>{if(!window.Cropper){E.emit(n,ye,{name:"Cropper",message:"Cropper is undefined"});return}const p=g.current.files||[];if(p?.length>0){const b=new FileReader;b.onload=C=>{v(x=>({...x,imgSelected:!0,imgSrc:C.target.result}))},b.readAsDataURL(p[0])}})},[e.visible,h.cropperInited,c,n]),d.useEffect(()=>{var p;(p=u.current)==null||p.setAttribute("style","")},[h.imgSelected]),d.useEffect(()=>{var p,b;je?.destroy(),(p=u.current)==null||p.setAttribute("style",""),f.current&&h.imgSrc&&(je=new window.Cropper(f.current,{viewMode:2,preview:((b=l.current)==null?void 0:b.getRootNode()).querySelector(`.${a}-clip-preview-target`)}))},[h.imgSrc,h.isFullscreen,l]);const w=d.useMemo(()=>h.isFullscreen?{width:"100%",height:"100%"}:{width:"668px",height:"392px"},[h.isFullscreen]),k=()=>{je.clear(),je.destroy(),je=null,g.current.value="",v(p=>({...p,imgSrc:"",imgSelected:!1}))},y=d.useCallback(p=>{v(b=>({...b,isFullscreen:p}))},[]);return d.useMemo(()=>{var p,b,C;return m.jsxs(Wi,{className:`${a}-modal-clip`,title:(p=s.clipModalTips)==null?void 0:p.title,visible:e.visible,onClose:e.onCancel,showAdjust:!0,isFullscreen:h.isFullscreen,onAdjust:y,...w,children:[m.jsxs("div",{className:`${a}-form-item ${a}-clip`,children:[m.jsx("div",{className:`${a}-clip-main`,children:h.imgSelected?m.jsxs("div",{className:`${a}-clip-cropper`,children:[m.jsx("img",{src:h.imgSrc,ref:f,style:{display:"none"},alt:""}),m.jsx("div",{className:`${a}-clip-delete`,onClick:k,children:m.jsx(z,{name:"delete"})})]}):m.jsx("div",{className:`${a}-clip-upload`,onClick:()=>{g.current.click()},role:"button",tabIndex:0,"aria-label":(b=s.imgTitleItem)==null?void 0:b.upload,children:m.jsx(z,{name:"upload"})})}),m.jsx("div",{className:`${a}-clip-preview`,children:m.jsx("div",{className:`${a}-clip-preview-target`,ref:u})})]}),m.jsx("div",{className:`${a}-form-item`,children:m.jsx("button",{className:`${a}-btn`,type:"button",onClick:()=>{if(je){const x=je.getCroppedCanvas();E.emit(n,Qe,[Sn(x.toDataURL("image/png"))],e.onOk),k()}},children:(C=s.linkModalTips)==null?void 0:C.buttonOK})}),m.jsx("input",{ref:g,accept:"image/*",type:"file",multiple:!1,style:{display:"none"},"aria-hidden":"true"})]})},[(t=s.clipModalTips)==null?void 0:t.title,(r=s.linkModalTips)==null?void 0:r.buttonOK,(i=s.imgTitleItem)==null?void 0:i.upload,e.visible,e.onCancel,e.onOk,h.isFullscreen,h.imgSelected,h.imgSrc,y,w,n])},js=e=>m.jsxs(m.Fragment,{children:[m.jsx(Es,{type:e.type,visible:e.linkVisible,onOk:e.onOk,onCancel:e.onCancel}),m.jsx(Ss,{visible:e.clipVisible,onOk:e.onOk,onCancel:e.onCancel})]}),Is=e=>{const[t,r]=d.useState({x:-1,y:-1}),i=d.useMemo(()=>JSON.stringify(e.tableShape),[e.tableShape]),o=d.useCallback(()=>{const l=[...JSON.parse(i)];return(!l[2]||l[2]<l[0])&&(l[2]=l[0]),(!l[3]||l[3]<l[3])&&(l[3]=l[1]),l},[i]),[n,s]=d.useState(o);return d.useEffect(()=>{s(o),r({x:-1,y:-1})},[o]),m.jsx("div",{className:`${a}-table-shape`,onMouseLeave:()=>{s(o),r({x:-1,y:-1})},children:new Array(n[1]).fill("").map((l,c)=>m.jsx("div",{className:`${a}-table-shape-row`,children:new Array(n[0]).fill("").map((g,f)=>m.jsx("div",{className:`${a}-table-shape-col`,onMouseEnter:()=>{r({x:c,y:f}),f+1===n[0]&&f+1<n[2]?s(u=>{const h=[...u];return h[0]=u[0]+1,h}):f+2<n[0]&&n[0]>e.tableShape[0]&&s(u=>{const h=[...u];return h[0]=u[0]-1,h}),c+1===n[1]&&c+1<n[3]?s(u=>{const h=[...u];return h[1]=u[1]+1,h}):c+2<n[1]&&n[1]>e.tableShape[1]&&s(u=>{const h=[...u];return h[1]=u[1]-1,h})},onClick:()=>{e.onSelected(t)},children:m.jsx("div",{className:[`${a}-table-shape-col-default`,c<=t.x&&f<=t.y&&`${a}-table-shape-col-include`].filter(u=>!!u).join(" ")})},`table-shape-col-${f}`))},`table-shape-row-${c}`))})},Ns=e=>{const{updateSetting:t}=e,{editorId:r}=d.useContext(ee),i=d.useRef(re.editorExtensions.screenfull.instance),o=d.useRef(!1),n=d.useCallback(s=>{if(!i.current){E.emit(r,ye,{name:"fullscreen",message:"fullscreen is undefined"});return}i.current.isEnabled?(o.current=!o.current,(s===void 0?!i.current.isFullscreen:s)?i.current.request():i.current.exit()):console.error("browser does not support screenfull!")},[r]);return d.useEffect(()=>{const s=()=>{t("fullscreen",o.current)};let l=-1;if(!i.current){const{editorExtensions:c,editorExtensionsAttrs:g}=re;l=requestAnimationFrame(()=>{var f;ge("script",{...(f=g.screenfull)==null?void 0:f.js,src:c.screenfull.js,id:ve.screenfull,onload(){i.current=window.screenfull,i.current&&i.current.isEnabled&&i.current.on("change",s)}},"screenfull")})}return i.current&&i.current.isEnabled&&i.current.on("change",s),()=>{i.current||cancelAnimationFrame(l),i.current&&i.current.isEnabled&&i.current.off("change",s)}},[t]),d.useEffect(()=>(E.on(r,{name:Tt,callback:n}),()=>{E.remove(r,Tt,n)}),[r,n]),{fullscreenHandler:n}},Ls=(e,t)=>{const{editorId:r}=d.useContext(ee),[i,o]=d.useState({type:"link",linkVisible:!1,clipVisible:!1}),n=d.useCallback(()=>{o(l=>({...l,linkVisible:!1,clipVisible:!1}))},[]),s=d.useCallback(l=>{l&&t(i.type,{desc:l.desc,url:l.url,transform:i.type==="image"}),n()},[t,i.type,n]);return d.useEffect(()=>{E.on(r,{name:Et,callback(c){o(g=>({...g,type:c,linkVisible:!0}))}});const l=()=>{E.emit(r,Qe,Array.from(e.current.files||[])),e.current.value=""};e.current.addEventListener("change",l)},[r,e]),{modalData:i,setModalData:o,onCancel:n,onOk:s}},As=e=>{const[t,r]=d.useState({title:!1,catalog:!1,image:!1,table:!1,mermaid:!1,katex:!1}),i=d.useCallback(v=>{r(w=>({...w,title:v}))},[]),o=d.useCallback(()=>{r(v=>({...v,title:!1}))},[]),n=d.useCallback(v=>{r(w=>({...w,image:v}))},[]),s=d.useCallback(()=>{r(v=>({...v,image:!1}))},[]),l=d.useCallback(v=>{r(w=>({...w,table:v}))},[]),c=d.useCallback(v=>{e("table",{selectedShape:v})},[e]),g=d.useCallback(v=>{r(w=>({...w,mermaid:v}))},[]),f=d.useCallback(()=>{r(v=>({...v,mermaid:!1}))},[]),u=d.useCallback(v=>{r(w=>({...w,katex:v}))},[]),h=d.useCallback(()=>{r(v=>({...v,katex:!1}))},[]);return{visible:t,onTitleChange:i,onTitleClose:o,onImageChange:n,onImageClose:s,onTableChange:l,onTableSelected:c,onMermaidChange:g,onMermaidClose:f,onKatexChange:u,onKatexClose:h}};let Rs=0;const Ms=e=>{var t,r,i,o,n,s,l,c,g,f,u,h,v,w,k,y,p,b,C,x,T,N,I,j,L,O,F,_,M,H,G,Z,q,V,ie,W,se,J,X,oe,Le,pe,B,de,ne,ue,be,Fe,Ce,et;const{toolbars:Ae,toolbarsExclude:zt,updateSetting:Ve,codeTheme:Vt}=e,{editorId:$e,usedLanguageText:so,theme:Wt,previewTheme:qt,language:Bt,disabled:R}=d.useContext(ee),$=so,[me]=d.useState(()=>`${$e}-toolbar-wrapper`),vt=d.useRef(null),bt=d.useRef(null),D=d.useCallback((U,Q)=>{if(R)return!1;E.emit($e,K,U,Q)},[R,$e]),{fullscreenHandler:Ut}=Ns(e),{modalData:We,setModalData:Oe,onCancel:lo,onOk:ao}=Ls(bt,D),{visible:xe,onTitleChange:Kt,onTitleClose:Gt,onImageChange:Zt,onImageClose:Xt,onTableChange:Yt,onTableSelected:Jt,onMermaidChange:Qt,onMermaidClose:er,onKatexChange:tr,onKatexClose:rr}=As(D),ir=d.useMemo(()=>{var U,Q,ae,ce,le,he,Te,Ee;return m.jsx(Ue,{relative:`#${me}`,visible:xe.title,onChange:Kt,overlay:m.jsxs("ul",{className:`${a}-menu`,onClick:Gt,role:"menu",children:[m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-title`,onClick:()=>{D("h1")},role:"menuitem",tabIndex:0,children:(U=$.titleItem)==null?void 0:U.h1}),m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-title`,onClick:()=>{D("h2")},role:"menuitem",tabIndex:0,children:(Q=$.titleItem)==null?void 0:Q.h2}),m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-title`,onClick:()=>{D("h3")},role:"menuitem",tabIndex:0,children:(ae=$.titleItem)==null?void 0:ae.h3}),m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-title`,onClick:()=>{D("h4")},role:"menuitem",tabIndex:0,children:(ce=$.titleItem)==null?void 0:ce.h4}),m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-title`,onClick:()=>{D("h5")},role:"menuitem",tabIndex:0,children:(le=$.titleItem)==null?void 0:le.h5}),m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-title`,onClick:()=>{D("h6")},role:"menuitem",tabIndex:0,children:(he=$.titleItem)==null?void 0:he.h6})]},"bar-title-overlay"),disabled:R,children:m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(Te=$.toolbarTips)==null?void 0:Te.title,children:[m.jsx(z,{name:"title"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(Ee=$.toolbarTips)==null?void 0:Ee.title})]},"bar-title-trigger")},"bar-title")},[me,xe.title,Kt,Gt,(t=$.titleItem)==null?void 0:t.h1,(r=$.titleItem)==null?void 0:r.h2,(i=$.titleItem)==null?void 0:i.h3,(o=$.titleItem)==null?void 0:o.h4,(n=$.titleItem)==null?void 0:n.h5,(s=$.titleItem)==null?void 0:s.h6,(l=$.toolbarTips)==null?void 0:l.title,R,e.showToolbarName,D]),or=d.useMemo(()=>{var U,Q,ae,ce,le;return m.jsx(Ue,{relative:`#${me}`,visible:xe.image,onChange:Zt,overlay:m.jsxs("ul",{className:`${a}-menu`,onClick:Xt,role:"menu",children:[m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-image`,onClick:()=>{e.insertLinkDirect?D("image"):Oe(he=>({...he,type:"image",linkVisible:!0}))},role:"menuitem",tabIndex:0,children:(U=$.imgTitleItem)==null?void 0:U.link}),m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-image`,onClick:()=>{bt.current.click()},role:"menuitem",tabIndex:0,children:(Q=$.imgTitleItem)==null?void 0:Q.upload}),m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-image`,onClick:()=>{Oe(he=>({...he,type:"image",clipVisible:!0}))},role:"menuitem",tabIndex:0,children:(ae=$.imgTitleItem)==null?void 0:ae.clip2upload})]},"bar-image-overlay"),disabled:R,children:m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(ce=$.toolbarTips)==null?void 0:ce.image,children:[m.jsx(z,{name:"image"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(le=$.toolbarTips)==null?void 0:le.image})]},"bar-image-trigger")},"bar-image")},[me,xe.image,Zt,Xt,(c=$.imgTitleItem)==null?void 0:c.link,(g=$.imgTitleItem)==null?void 0:g.upload,(f=$.imgTitleItem)==null?void 0:f.clip2upload,(u=$.toolbarTips)==null?void 0:u.image,R,e.showToolbarName,e.insertLinkDirect,D,Oe]),nr=d.useMemo(()=>{var U,Q;return m.jsx(Ue,{relative:`#${me}`,visible:xe.table,onChange:Yt,disabled:R,overlay:m.jsx(Is,{tableShape:e.tableShape,onSelected:Jt},"bar-table-overlay"),children:m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(U=$.toolbarTips)==null?void 0:U.table,children:[m.jsx(z,{name:"table"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(Q=$.toolbarTips)==null?void 0:Q.table})]},"bar-table-trigger")},"bar-table")},[me,xe.table,Yt,R,e.tableShape,e.showToolbarName,Jt,(h=$.toolbarTips)==null?void 0:h.table]),sr=d.useMemo(()=>{var U,Q,ae,ce,le,he,Te,Ee,qe,Be;return m.jsx(Ue,{relative:`#${me}`,visible:xe.mermaid,onChange:Qt,overlay:m.jsxs("ul",{className:`${a}-menu`,onClick:er,role:"menu",children:[m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-mermaid`,onClick:()=>{D("flow")},role:"menuitem",tabIndex:0,children:(U=$.mermaid)==null?void 0:U.flow}),m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-mermaid`,onClick:()=>{D("sequence")},role:"menuitem",tabIndex:0,children:(Q=$.mermaid)==null?void 0:Q.sequence}),m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-mermaid`,onClick:()=>{D("gantt")},role:"menuitem",tabIndex:0,children:(ae=$.mermaid)==null?void 0:ae.gantt}),m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-mermaid`,onClick:()=>{D("class")},role:"menuitem",tabIndex:0,children:(ce=$.mermaid)==null?void 0:ce.class}),m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-mermaid`,onClick:()=>{D("state")},role:"menuitem",tabIndex:0,children:(le=$.mermaid)==null?void 0:le.state}),m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-mermaid`,onClick:()=>{D("pie")},role:"menuitem",tabIndex:0,children:(he=$.mermaid)==null?void 0:he.pie}),m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-mermaid`,onClick:()=>{D("relationship")},role:"menuitem",tabIndex:0,children:(Te=$.mermaid)==null?void 0:Te.relationship}),m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-mermaid`,onClick:()=>{D("journey")},role:"menuitem",tabIndex:0,children:(Ee=$.mermaid)==null?void 0:Ee.journey})]},"bar-mermaid-overlay"),disabled:R,children:m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(qe=$.toolbarTips)==null?void 0:qe.mermaid,children:[m.jsx(z,{name:"mermaid"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(Be=$.toolbarTips)==null?void 0:Be.mermaid})]},"bar-mermaid-trigger")},"bar-mermaid")},[me,xe.mermaid,Qt,er,(v=$.mermaid)==null?void 0:v.flow,(w=$.mermaid)==null?void 0:w.sequence,(k=$.mermaid)==null?void 0:k.gantt,(y=$.mermaid)==null?void 0:y.class,(p=$.mermaid)==null?void 0:p.state,(b=$.mermaid)==null?void 0:b.pie,(C=$.mermaid)==null?void 0:C.relationship,(x=$.mermaid)==null?void 0:x.journey,(T=$.toolbarTips)==null?void 0:T.mermaid,R,e.showToolbarName,D]),lr=d.useMemo(()=>{var U,Q,ae,ce;return m.jsx(Ue,{relative:`#${me}`,visible:xe.katex,onChange:tr,overlay:m.jsxs("ul",{className:`${a}-menu`,onClick:rr,role:"menu",children:[m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-katex`,onClick:()=>{D("katexInline")},role:"menuitem",tabIndex:0,children:(U=$.katex)==null?void 0:U.inline}),m.jsx("li",{className:`${a}-menu-item ${a}-menu-item-katex`,onClick:()=>{D("katexBlock")},role:"menuitem",tabIndex:0,children:(Q=$.katex)==null?void 0:Q.block})]},"bar-katex-overlay"),disabled:R,children:m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(ae=$.toolbarTips)==null?void 0:ae.katex,children:[m.jsx(z,{name:"formula"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(ce=$.toolbarTips)==null?void 0:ce.katex})]},"bar-katex-trigger")},"bar-katex")},[me,xe.katex,tr,rr,(N=$.katex)==null?void 0:N.inline,(I=$.katex)==null?void 0:I.block,(j=$.toolbarTips)==null?void 0:j.katex,R,e.showToolbarName,D]),xt=d.useCallback(U=>{var Q,ae,ce,le,he,Te,Ee,qe,Be,cr,dr,ur,mr,hr,fr,pr,gr,vr,br,xr,wr,kr,$r,yr,Cr,Tr,Er,Sr,jr,Ir,Nr,Lr,Ar,Rr,Mr,Fr,Or,Hr,_r,Dr,Pr,zr,Vr,Wr,qr,Br,Ur,Kr,Gr,Zr;if(Fi.includes(U))switch(U){case"-":return m.jsx(Ts,{},`bar-${Rs++}`);case"bold":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(Q=$.toolbarTips)==null?void 0:Q.bold,onClick:()=>{D("bold")},children:[m.jsx(z,{name:"bold"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(ae=$.toolbarTips)==null?void 0:ae.bold})]},"bar-bold");case"underline":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(ce=$.toolbarTips)==null?void 0:ce.underline,onClick:()=>{D("underline")},children:[m.jsx(z,{name:"underline"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(le=$.toolbarTips)==null?void 0:le.underline})]},"bar-underline");case"italic":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(he=$.toolbarTips)==null?void 0:he.italic,onClick:()=>{D("italic")},children:[m.jsx(z,{name:"italic"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(Te=$.toolbarTips)==null?void 0:Te.italic})]},"bar-italic");case"strikeThrough":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(Ee=$.toolbarTips)==null?void 0:Ee.strikeThrough,onClick:()=>{D("strikeThrough")},children:[m.jsx(z,{name:"strike-through"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(qe=$.toolbarTips)==null?void 0:qe.strikeThrough})]},"bar-strikeThrough");case"title":return ir;case"sub":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(Be=$.toolbarTips)==null?void 0:Be.sub,onClick:()=>{D("sub")},children:[m.jsx(z,{name:"sub"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(cr=$.toolbarTips)==null?void 0:cr.sub})]},"bar-sub");case"sup":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(dr=$.toolbarTips)==null?void 0:dr.sup,onClick:()=>{D("sup")},children:[m.jsx(z,{name:"sup"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(ur=$.toolbarTips)==null?void 0:ur.sup})]},"bar-sup");case"quote":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(mr=$.toolbarTips)==null?void 0:mr.quote,onClick:()=>{D("quote")},children:[m.jsx(z,{name:"quote"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(hr=$.toolbarTips)==null?void 0:hr.quote})]},"bar-quote");case"unorderedList":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(fr=$.toolbarTips)==null?void 0:fr.unorderedList,onClick:()=>{D("unorderedList")},children:[m.jsx(z,{name:"unordered-list"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(pr=$.toolbarTips)==null?void 0:pr.unorderedList})]},"bar-unorderedList");case"orderedList":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(gr=$.toolbarTips)==null?void 0:gr.orderedList,onClick:()=>{D("orderedList")},children:[m.jsx(z,{name:"ordered-list"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(vr=$.toolbarTips)==null?void 0:vr.orderedList})]},"bar-orderedList");case"task":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(br=$.toolbarTips)==null?void 0:br.task,onClick:()=>{D("task")},children:[m.jsx(z,{name:"task"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(xr=$.toolbarTips)==null?void 0:xr.task})]},"bar-task");case"codeRow":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(wr=$.toolbarTips)==null?void 0:wr.codeRow,onClick:()=>{D("codeRow")},children:[m.jsx(z,{name:"code-row"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(kr=$.toolbarTips)==null?void 0:kr.codeRow})]},"bar-codeRow");case"code":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:($r=$.toolbarTips)==null?void 0:$r.code,onClick:()=>{D("code")},children:[m.jsx(z,{name:"code"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(yr=$.toolbarTips)==null?void 0:yr.code})]},"bar-code");case"link":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(Cr=$.toolbarTips)==null?void 0:Cr.link,onClick:()=>{if(R)return!1;e.insertLinkDirect?D("link"):Oe({...We,type:"link",linkVisible:!0})},children:[m.jsx(z,{name:"link"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(Tr=$.toolbarTips)==null?void 0:Tr.link})]},"bar-link");case"image":return e.noUploadImg?m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(Er=$.toolbarTips)==null?void 0:Er.image,onClick:()=>{if(R)return!1;e.insertLinkDirect?D("image"):Oe(we=>({...we,type:"image",linkVisible:!0}))},children:[m.jsx(z,{name:"image"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(Sr=$.toolbarTips)==null?void 0:Sr.image})]},"bar-image-no-upload"):or;case"table":return nr;case"revoke":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(jr=$.toolbarTips)==null?void 0:jr.revoke,onClick:()=>{if(R)return!1;E.emit($e,St)},children:[m.jsx(z,{name:"revoke"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(Ir=$.toolbarTips)==null?void 0:Ir.revoke})]},"bar-revoke");case"next":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(Nr=$.toolbarTips)==null?void 0:Nr.next,onClick:()=>{if(R)return!1;E.emit($e,jt)},children:[m.jsx(z,{name:"next"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(Lr=$.toolbarTips)==null?void 0:Lr.next})]},"bar-next");case"save":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(Ar=$.toolbarTips)==null?void 0:Ar.save,onClick:()=>{if(R)return!1;E.emit($e,Je)},children:[m.jsx(z,{name:"save"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(Rr=$.toolbarTips)==null?void 0:Rr.save})]},"bar-save");case"prettier":return e.noPrettier?"":m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(Mr=$.toolbarTips)==null?void 0:Mr.prettier,onClick:()=>{D("prettier")},children:[m.jsx(z,{name:"prettier"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(Fr=$.toolbarTips)==null?void 0:Fr.prettier})]},"bar-prettier");case"pageFullscreen":return!e.setting.fullscreen&&m.jsxs("div",{className:P([`${a}-toolbar-item`,e.setting.pageFullscreen&&`${a}-toolbar-active`,R&&`${a}-disabled`]),title:(Or=$.toolbarTips)==null?void 0:Or.pageFullscreen,onClick:()=>{if(R)return!1;Ve("pageFullscreen")},children:[m.jsx(z,{name:e.setting.pageFullscreen?"minimize":"maximize"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(Hr=$.toolbarTips)==null?void 0:Hr.pageFullscreen})]},"bar-pageFullscreen");case"fullscreen":return m.jsxs("div",{className:P([`${a}-toolbar-item`,e.setting.fullscreen&&`${a}-toolbar-active`,R&&`${a}-disabled`]),title:(_r=$.toolbarTips)==null?void 0:_r.fullscreen,onClick:()=>{if(R)return!1;Ut()},children:[m.jsx(z,{name:e.setting.fullscreen?"fullscreen-exit":"fullscreen"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(Dr=$.toolbarTips)==null?void 0:Dr.fullscreen})]},"bar-fullscreen");case"catalog":return m.jsxs("div",{className:P([`${a}-toolbar-item`,e.catalogVisible&&`${a}-toolbar-active`,R&&`${a}-disabled`]),title:(Pr=$.toolbarTips)==null?void 0:Pr.catalog,onClick:()=>{if(R)return!1;E.emit($e,dt)},children:[m.jsx(z,{name:"catalog"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(zr=$.toolbarTips)==null?void 0:zr.catalog})]},"bar-catalog");case"preview":return m.jsxs("div",{className:P([`${a}-toolbar-item`,e.setting.preview&&`${a}-toolbar-active`,R&&`${a}-disabled`]),title:(Vr=$.toolbarTips)==null?void 0:Vr.preview,onClick:()=>{if(R)return!1;Ve("preview")},children:[m.jsx(z,{name:"preview"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(Wr=$.toolbarTips)==null?void 0:Wr.preview})]},"bar-preview");case"previewOnly":return m.jsxs("div",{className:P([`${a}-toolbar-item`,e.setting.previewOnly&&`${a}-toolbar-active`,R&&`${a}-disabled`]),title:(qr=$.toolbarTips)==null?void 0:qr.previewOnly,onClick:()=>{if(R)return!1;Ve("previewOnly")},children:[m.jsx(z,{name:"preview-only"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(Br=$.toolbarTips)==null?void 0:Br.previewOnly})]},"bar-preview-only");case"htmlPreview":return m.jsxs("div",{className:P([`${a}-toolbar-item`,e.setting.htmlPreview&&`${a}-toolbar-active`,R&&`${a}-disabled`]),title:(Ur=$.toolbarTips)==null?void 0:Ur.htmlPreview,onClick:()=>{if(R)return!1;Ve("htmlPreview")},children:[m.jsx(z,{name:"preview-html"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(Kr=$.toolbarTips)==null?void 0:Kr.htmlPreview})]},"bar-htmlPreview");case"github":return m.jsxs("div",{className:P([`${a}-toolbar-item`,R&&`${a}-disabled`]),title:(Gr=$.toolbarTips)==null?void 0:Gr.github,onClick:()=>{if(R)return!1;ho("https://github.com/imzbf/md-editor-rt")},children:[m.jsx(z,{name:"github"}),e.showToolbarName&&m.jsx("div",{className:`${a}-toolbar-item-name`,children:(Zr=$.toolbarTips)==null?void 0:Zr.github})]},"bar-github");case"mermaid":return sr;case"katex":return lr}else if(e.defToolbars){const we=e.defToolbars[U];return we?d.cloneElement(we,{theme:we.props.theme||Wt,codeTheme:we.props.codeTheme||Vt,previewTheme:we.props.previewTheme||qt,language:we.props.language||Bt,disabled:we.props.disabled||R,showToolbarName:we.props.showToolbarName||e.showToolbarName,insert(co){E.emit($e,K,"universal",{generate:co})}}):""}else return""},[e,R,(L=$.toolbarTips)==null?void 0:L.bold,(O=$.toolbarTips)==null?void 0:O.underline,(F=$.toolbarTips)==null?void 0:F.italic,(_=$.toolbarTips)==null?void 0:_.strikeThrough,(M=$.toolbarTips)==null?void 0:M.sub,(H=$.toolbarTips)==null?void 0:H.sup,(G=$.toolbarTips)==null?void 0:G.quote,(Z=$.toolbarTips)==null?void 0:Z.unorderedList,(q=$.toolbarTips)==null?void 0:q.orderedList,(V=$.toolbarTips)==null?void 0:V.task,(ie=$.toolbarTips)==null?void 0:ie.codeRow,(W=$.toolbarTips)==null?void 0:W.code,(se=$.toolbarTips)==null?void 0:se.link,(J=$.toolbarTips)==null?void 0:J.image,(X=$.toolbarTips)==null?void 0:X.revoke,(oe=$.toolbarTips)==null?void 0:oe.next,(Le=$.toolbarTips)==null?void 0:Le.save,(pe=$.toolbarTips)==null?void 0:pe.prettier,(B=$.toolbarTips)==null?void 0:B.pageFullscreen,(de=$.toolbarTips)==null?void 0:de.fullscreen,(ne=$.toolbarTips)==null?void 0:ne.catalog,(ue=$.toolbarTips)==null?void 0:ue.preview,(be=$.toolbarTips)==null?void 0:be.previewOnly,(Fe=$.toolbarTips)==null?void 0:Fe.htmlPreview,(Ce=$.toolbarTips)==null?void 0:Ce.github,D,ir,Oe,We,or,nr,$e,Ve,Ut,sr,lr,Wt,Vt,qt,Bt]),ar=d.useMemo(()=>{const U=Ae.filter(le=>!zt.includes(le)),Q=U.indexOf("="),ae=Q===-1?U:U.slice(0,Q+1),ce=Q===-1?[]:U.slice(Q,Number.MAX_SAFE_INTEGER);return[ae.map(le=>xt(le)),ce.map(le=>xt(le))]},[Ae,zt,xt]);return d.useEffect(()=>{let U=()=>{};return vt.current&&(U=fo(vt.current)),()=>{U()}},[Ae]),m.jsxs(m.Fragment,{children:[Ae.length>0&&m.jsx("div",{className:`${a}-toolbar-wrapper`,ref:vt,id:me,children:m.jsxs("div",{className:P([`${a}-toolbar`,e.showToolbarName&&`${a}-stn`]),children:[m.jsx("div",{className:`${a}-toolbar-left`,children:ar[0]}),m.jsx("div",{className:`${a}-toolbar-right`,children:ar[1]})]})}),m.jsx("label",{htmlFor:`${me}_label`,style:{display:"none"},"aria-label":(et=$.imgTitleItem)==null?void 0:et.upload}),m.jsx("input",{id:`${me}_label`,ref:bt,accept:"image/*",type:"file",multiple:!0,style:{display:"none"}}),m.jsx(js,{linkVisible:We.linkVisible,clipVisible:We.clipVisible,type:We.type,onCancel:lo,onOk:ao})]})},Fs=d.memo(Ms),Os=(e,t,r)=>{const{editorId:i}=d.useContext(ee),[o,n]=d.useState({clear(){},init(){}});d.useEffect(()=>{var s;const l=(s=r.current)==null?void 0:s.view.contentDOM.getRootNode(),c=l.querySelector(`#${i} .cm-scroller`),g=l.querySelector(`[id="${i}-preview-wrapper"]`),f=l.querySelector(`[id="${i}-html-wrapper"]`);if(g||f){const u=g?ws:xs,h=g||f,[v,w]=u(c,h,r.current);n({init:v,clear:w})}},[t,e.setting.fullscreen,e.setting.pageFullscreen,e.setting.preview,e.setting.htmlPreview,i,r]),d.useEffect(()=>(e.scrollAuto&&!e.setting.previewOnly&&(e.setting.preview||e.setting.htmlPreview)?o.init():o.clear(),()=>{o.clear()}),[o,e.scrollAuto,e.setting.preview,e.setting.htmlPreview,e.setting.previewOnly])},kt=async(e,t,r)=>{if(/^h[1-6]$/.test(e))return Hs(e,t);if(e==="prettier")return await _s(t,r);switch(e){case"bold":case"underline":case"italic":case"strikeThrough":case"sub":case"sup":case"codeRow":case"katexInline":case"katexBlock":return Ps(e,t);case"quote":case"orderedList":case"unorderedList":case"task":return Vs(e,t);case"code":return Ws(r,t);case"table":return Us(r);case"link":{const{desc:i="",url:o=""}=r,n=`[${i}](${o})`;return{text:n,options:{select:o==="",deviationStart:n.length-o.length-1,deviationEnd:-1}}}case"image":return Bs(r);case"flow":case"sequence":case"gantt":case"class":case"state":case"pie":case"relationship":case"journey":return qs(e);case"universal":return Ks(t.getSelectedText(),r);default:return{text:"",options:{}}}},Hs=(e,t)=>{const r=e.slice(1),i="#".repeat(Number(r)),[o,n,s]=_t(t,{wholeLine:!0});return{text:`${i} ${o}`,options:{deviationStart:i.length+1,replaceStart:n,replaceEnd:s}}},_s=async(e,t)=>{var r,i,o;const n=window.prettier||((r=re.editorExtensions.prettier)==null?void 0:r.prettierInstance),s=[((i=window.prettierPlugins)==null?void 0:i.markdown)||((o=re.editorExtensions.prettier)==null?void 0:o.parserMarkdownInstance)];return!n||!s[0]?(E.emit(t.editorId,ye,{name:"prettier",message:"prettier is undefined"}),{text:e.getValue(),options:{select:!1,replaceAll:!0}}):{text:await n.format(e.getValue(),{parser:"markdown",plugins:s}),options:{select:!1,replaceAll:!0}}},Ds={bold:["**","**",2,-2],underline:["<u>","</u>",3,-4],italic:["*","*",1,-1],strikeThrough:["~~","~~",2,-2],sub:["~","~",1,-1],sup:["^","^",1,-1],codeRow:["`","`",1,-1],katexInline:["$","$",1,-1],katexBlock:[`
$$
`,`
$$
`,4,-4]},Ps=(e,t)=>{const r=t.getSelectedText(),[i,o,n,s]=Ds[e];return{text:`${i}${r}${o}`,options:{deviationStart:n,deviationEnd:s}}},zs={quote:"> ",unorderedList:"- ",orderedList:1,task:"- [ ] "},Vs=(e,t)=>{const[r,i,o]=_t(t,{wholeLine:!0}),n=r.split(`
`),s=zs[e],l=e==="orderedList"?n.map((f,u)=>`${s+u}. ${f}`):n.map(f=>`${s}${f}`),c=e==="orderedList"?"1. ":s.toString(),g=n.length===1?c.length:0;return{text:l.join(`
`),options:{deviationStart:g,replaceStart:i,replaceEnd:o}}},Ws=(e,t)=>{const[r,i,o]=_t(t),n=e.mode||"language",s=`
\`\`\`${n}
${e.text||r||""}
\`\`\`
`;return{text:s,options:{deviationStart:4,deviationEnd:4+n.length-s.length,replaceStart:i,replaceEnd:o}}},qs=e=>({text:`
\`\`\`mermaid
${{flow:`flowchart TD 
  Start --> Stop`,sequence:`sequenceDiagram
  A->>B: hello!
  B-->>A: hi!`,gantt:`gantt
title Gantt Chart
dateFormat  YYYY-MM-DD`,class:`classDiagram
  class Animal`,state:`stateDiagram-v2
  s1 --> s2`,pie:`pie
  "Dogs" : 386
  "Cats" : 85
  "Rats" : 15`,relationship:`erDiagram
  CAR ||--o{ NAMED-DRIVER : allows`,journey:`journey
  title My Journey`,...re.editorConfig.mermaidTemplate}[e]}
\`\`\`
`,options:{deviationStart:12,deviationEnd:-5}}),Bs=e=>{const{desc:t="",url:r="",urls:i}=e;let o="";const n=r===""&&(!i||i instanceof Array&&i.length===0);return i instanceof Array?o=i.reduce((s,l)=>{const{url:c="",alt:g="",title:f=""}=typeof l=="object"?l:{url:l};return s+`![${g}](${c}${f?" '"+f+"'":""})
`},""):o=`![${t}](${r})
`,{text:o,options:{select:r==="",deviationStart:n?o.length-r.length-2:o.length,deviationEnd:n?-2:0}}},Us=e=>{const{selectedShape:t={x:1,y:1}}=e,{x:r,y:i}=t;let o=`
| Column`;for(let n=0;n<=i;n++)o+=" |";o+=`
|`;for(let n=0;n<=i;n++)o+=" - |";for(let n=0;n<=r;n++){o+=`
|`;for(let s=0;s<=i;s++)o+=" |"}return o+=`
`,{text:o,options:{deviationStart:3,deviationEnd:10-o.length}}},Ks=(e,t)=>{const{generate:r}=t,i=r(e);return{text:i.targetValue,options:{select:i.select??!0,deviationStart:i.deviationStart||0,deviationEnd:i.deviationEnd||0}}},_t=(e,t={wholeLine:!1})=>{const r=e.view.state,i=r.selection.main;if(i.empty){const o=r.doc.lineAt(i.from);return[r.doc.lineAt(i.from).text,o.from,o.to]}else if(t.wholeLine){const o=r.doc.lineAt(i.from),n=r.doc.lineAt(i.to);return[r.doc.sliceString(o.from,n.to),o.from,n.to]}return[r.doc.sliceString(i.from,i.to),i.from,i.to]},_e=e=>{const t=new Re;return r=>(t.get(e.state)?e.dispatch({effects:t.reconfigure(r)}):e.dispatch({effects:an.appendConfig.of(t.of(r))}),!0)};class Gs{constructor(t){Se(this,"view"),Se(this,"maxLength",Number.MAX_SAFE_INTEGER),Se(this,"toggleTabSize"),Se(this,"togglePlaceholder"),Se(this,"setExtensions"),Se(this,"toggleDisabled"),Se(this,"toggleReadOnly"),Se(this,"toggleMaxlength"),this.view=t,this.toggleTabSize=_e(this.view),this.togglePlaceholder=_e(this.view),this.setExtensions=_e(this.view),this.toggleDisabled=_e(this.view),this.toggleReadOnly=_e(this.view),this.toggleMaxlength=_e(this.view)}getValue(){return this.view.state.doc.toString()}setValue(t,r=0,i=this.view.state.doc.length){this.view.dispatch({changes:{from:r,to:i,insert:t}})}getSelectedText(){const{from:t,to:r}=this.view.state.selection.main;return this.view.state.sliceDoc(t,r)}replaceSelectedText(t,r,i){const o={select:!0,deviationStart:0,deviationEnd:0,replaceAll:!1,replaceStart:-1,replaceEnd:-1,...r};try{if(o.replaceAll){if(this.setValue(t),t.length>this.maxLength)throw new Error("The input text is too long");return}if(this.view.state.doc.length-this.getSelectedText().length+t.length>this.maxLength)throw new Error("The input text is too long");const{from:n}=this.view.state.selection.main;o.replaceStart!==-1?this.view.dispatch({changes:{from:o.replaceStart,to:o.replaceEnd,insert:t}}):this.view.dispatch(this.view.state.replaceSelection(t)),o.select&&this.view.dispatch({selection:{anchor:o.replaceStart===-1?n+o.deviationStart:o.replaceStart+o.deviationStart,head:o.replaceStart===-1?n+t.length+o.deviationEnd:o.replaceStart+t.length+o.deviationEnd}}),this.view.focus()}catch(n){if(n.message==="The input text is too long")E.emit(i,ye,{name:"overlength",message:n.message,data:t});else throw n}}setTabSize(t){this.toggleTabSize([wt.tabSize.of(t),sn.of(" ".repeat(t))])}setPlaceholder(t){this.togglePlaceholder(ln(t))}focus(t){if(this.view.focus(),!t)return;let r=0,i=0,o=0;switch(t){case"start":break;case"end":{r=i=o=this.getValue().length;break}default:r=t.rangeAnchor||t.cursorPos,i=t.rangeHead||t.cursorPos,o=t.cursorPos}this.view.dispatch({scrollIntoView:!0,selection:ze.create([ze.range(r,i),ze.cursor(o)],1)})}setDisabled(t){this.toggleDisabled([ke.editable.of(!t)])}setReadOnly(t){this.toggleReadOnly([wt.readOnly.of(t)])}setMaxLength(t){this.maxLength=t,this.toggleMaxlength([wt.changeFilter.of(r=>r.newDoc.length<=t)])}}const Zs="#e5c07b",hi="var(--md-color)",Xs="#56b6c2",Ys="#ffffff",Ze="var(--md-color)",fi="#e5c07b",Js="#e5c07b",Qs="var(--md-color)",pi="#d19a66",el="#c678dd",tl="#21252b",rl="#2c313a",gi="var(--md-bk-color)",$t="var(--md-bk-color)",il="#ceedfa33",vi="#528bff",ol=ke.theme({"&":{color:Ze,backgroundColor:gi},".cm-content":{caretColor:vi},".cm-cursor, .cm-dropCursor":{borderLeftColor:vi},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:il},".cm-panels":{backgroundColor:tl,color:Ze},".cm-panels.cm-panels-top":{borderBottom:"1px solid var(--md-border-color)"},".cm-panels.cm-panels-bottom":{borderTop:"1px solid var(--md-border-color)"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:gi,color:Ze,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:rl},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:$t},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:$t,borderBottomColor:$t},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:Ze}}},{dark:!0}),nl=Mi.define([{tag:S.keyword,color:el},{tag:[S.name,S.deleted,S.character,S.propertyName,S.macroName],color:hi},{tag:[S.function(S.variableName),S.labelName],color:Js},{tag:[S.color,S.constant(S.name),S.standard(S.name)],color:pi},{tag:[S.definition(S.name),S.separator],color:Ze},{tag:[S.typeName,S.className,S.number,S.changed,S.annotation,S.modifier,S.self,S.namespace],color:Zs},{tag:[S.operator,S.operatorKeyword,S.url,S.escape,S.regexp,S.link,S.special(S.string)],color:Xs},{tag:[S.meta,S.comment],color:fi},{tag:S.strong,fontWeight:"bold"},{tag:S.emphasis,fontStyle:"italic"},{tag:S.strikethrough,textDecoration:"line-through"},{tag:S.link,color:fi,textDecoration:"underline"},{tag:S.heading,fontWeight:"bold",color:hi},{tag:[S.atom,S.bool,S.special(S.variableName)],color:pi},{tag:[S.processingInstruction,S.string,S.inserted],color:Qs},{tag:S.invalid,color:Ys}]),bi=[ol,Ri(nl)],sl="#e5c07b",xi="var(--md-color)",ll="#56b6c2",al="#fff",Xe="#3f4a54",wi="#2d8cf0",cl="#2d8cf0",dl="#3f4a54",ki="#d19a66",ul="#c678dd",ml="#f6f6f6",hl="#ceedfa33",$i="var(--md-bk-color)",yt="var(--md-bk-color)",fl="#bad5fa",yi="#3f4a54",pl=ke.theme({"&":{color:Xe,backgroundColor:$i},".cm-content":{caretColor:yi},".cm-cursor, .cm-dropCursor":{borderLeftColor:yi},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:fl},".cm-panels":{backgroundColor:ml,color:Xe},".cm-panels.cm-panels-top":{borderBottom:"1px solid var(--md-border-color)"},".cm-panels.cm-panels-bottom":{borderTop:"1px solid var(--md-border-color)"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:$i,color:Xe,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:hl},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:yt},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:yt,borderBottomColor:yt},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:Xe}}}),gl=Mi.define([{tag:S.keyword,color:ul},{tag:[S.name,S.deleted,S.character,S.propertyName,S.macroName],color:xi},{tag:[S.function(S.variableName),S.labelName],color:cl},{tag:[S.color,S.constant(S.name),S.standard(S.name)],color:ki},{tag:[S.definition(S.name),S.separator],color:Xe},{tag:[S.typeName,S.className,S.number,S.changed,S.annotation,S.modifier,S.self,S.namespace],color:sl},{tag:[S.operator,S.operatorKeyword,S.url,S.escape,S.regexp,S.link,S.special(S.string)],color:ll},{tag:[S.meta,S.comment],color:wi},{tag:S.strong,fontWeight:"bold"},{tag:S.emphasis,fontStyle:"italic"},{tag:S.strikethrough,textDecoration:"line-through"},{tag:S.link,color:wi,textDecoration:"underline"},{tag:S.heading,fontWeight:"bold",color:xi},{tag:[S.atom,S.bool,S.special(S.variableName)],color:ki},{tag:[S.processingInstruction,S.string,S.inserted],color:dl},{tag:S.invalid,color:al}]),Ci=[pl,Ri(gl)],rt=(e,t,r,i,o)=>(n,s,l,c)=>{const g=`${e}${t}${r}${i}`,f=l+s.label.length+(o==="title"?r.length:0);n.dispatch({changes:{from:l,to:c,insert:g},selection:ze.create([ze.range(l+s.label.length+(o==="title"?1:-t.length),f),ze.cursor(f)],1)}),n.focus()},Ti=e=>(t,r,i,o)=>{const n=e.slice(o-i);t.dispatch(t.state.replaceSelection(`${n} `))},Ei=e=>{const t=r=>{const i=r.matchBefore(/^#+|^-\s*\[*\s*\]*|`+|\[|!\[*|^\|\s?\|?|\$\$?|!+\s*\w*/);return i===null||i.from==i.to&&r.explicit?null:{from:i.from,options:[...["h2","h3","h4","h5","h6"].map((o,n)=>{const s=new Array(n+2).fill("#").join("");return{label:s,type:"text",apply:Ti(s)}}),...["unchecked","checked"].map(o=>{const n=o==="checked"?"- [x]":"- [ ]";return{label:n,type:"text",apply:Ti(n)}}),...[["`",""],["```","language"],["```mermaid\n",""]].map(o=>({label:`${o[0]}${o[1]}`,type:"text",apply:rt(o[0],o[1],"",o[0]==="`"?"`":"\n```","type")})),{label:"[]()",type:"text"},{label:"![]()",type:"text"},{label:"| |",type:"text",detail:"table",apply:`| col | col | col |
| - | - | - |
| content | content | content |
| content | content | content |`},{label:"$",type:"text",apply:rt("$","","","$","type")},{label:"$$",type:"text",apply:rt("$$","",`
`,`
$$`,"title")},...["note","abstract","info","tip","success","question","warning","failure","danger","bug","example","quote","hint","caution","error","attention"].map(o=>({label:`!!! ${o}`,type:"text",apply:rt("!!!",` ${o}`," Title",`

!!!`,"title")}))]}};return nn({override:e?[t,...e]:[t]})},vl=(e,t)=>[{key:"Ctrl-b",mac:"Cmd-b",run:()=>(E.emit(e,K,"bold"),!0)},{key:"Ctrl-d",mac:"Cmd-d",run:Ko,preventDefault:!0},{key:"Ctrl-s",mac:"Cmd-s",run:r=>(E.emit(e,Je,r.state.doc.toString()),!0),shift:()=>(E.emit(e,K,"strikeThrough"),!0)},{key:"Ctrl-u",mac:"Cmd-u",preventDefault:!0,run:()=>(E.emit(e,K,"underline"),!0),shift:()=>(E.emit(e,K,"unorderedList"),!0)},{key:"Ctrl-i",mac:"Cmd-i",preventDefault:!0,run:()=>(E.emit(e,K,"italic"),!0),shift:()=>(E.emit(e,Et,"image"),!0)},{key:"Ctrl-1",mac:"Cmd-1",run:()=>(E.emit(e,K,"h1"),!0)},{key:"Ctrl-2",mac:"Cmd-2",run:()=>(E.emit(e,K,"h2"),!0)},{key:"Ctrl-3",mac:"Cmd-3",run:()=>(E.emit(e,K,"h3"),!0)},{key:"Ctrl-4",mac:"Cmd-4",run:()=>(E.emit(e,K,"h4"),!0)},{key:"Ctrl-5",mac:"Cmd-5",run:()=>(E.emit(e,K,"h5"),!0)},{key:"Ctrl-6",mac:"Cmd-6",run:()=>(E.emit(e,K,"h6"),!0)},{key:"Ctrl-ArrowUp",mac:"Cmd-ArrowUp",run:()=>(E.emit(e,K,"sup"),!0)},{key:"Ctrl-ArrowDown",mac:"Cmd-ArrowDown",run:()=>(E.emit(e,K,"sub"),!0)},{key:"Ctrl-o",mac:"Cmd-o",run:()=>(E.emit(e,K,"orderedList"),!0)},{key:"Ctrl-c",mac:"Cmd-c",shift:()=>(E.emit(e,K,"code"),!0),any(r,i){return(i.ctrlKey||i.metaKey)&&i.altKey&&i.code==="KeyC"?(E.emit(e,K,"codeRow"),!0):!1}},{key:"Ctrl-l",mac:"Cmd-l",run:()=>(E.emit(e,Et,"link"),!0)},{key:"Ctrl-f",mac:"Cmd-f",shift:()=>t.noPrettier?!1:(E.emit(e,K,"prettier"),!0)},{any:(r,i)=>(i.ctrlKey||i.metaKey)&&i.altKey&&i.shiftKey&&i.code==="KeyT"?(E.emit(e,K,"table"),!0):!1},...Go],bl=(e,t)=>{const{editorId:r}=d.useContext(ee),i=d.useCallback(o=>{o instanceof Promise?o.then(n=>{E.emit(r,K,"universal",{generate(){return{targetValue:n}}})}).catch(n=>{console.error(n)}):E.emit(r,K,"universal",{generate(){return{targetValue:o}}})},[r]);return d.useCallback(o=>{var n,s,l;if(!o.clipboardData)return;if(o.clipboardData.files.length>0){const{files:w}=o.clipboardData;E.emit(r,Qe,Array.from(w).filter(k=>/image\/.*/.test(k.type))),o.preventDefault();return}const c=o.clipboardData.getData("text/plain"),g=((n=t.current)==null?void 0:n.view.state.selection.main.to)||0,f=((s=t.current)==null?void 0:s.view.state.doc.lineAt(g).from)||0,u=((l=t.current)==null?void 0:l.view.state.doc.sliceString(f,g))||"",h=/!\[.*\]\(\s*$/.test(u),v=/!\[.*\]\((.*)\s?.*\)/.test(c);if(h){const w=e.transformImgUrl(c);i(w),o.preventDefault();return}else if(v){const w=c.match(new RegExp(`(?<=!\\[.*\\]\\()([^)\\s]+)(?=\\s?["']?.*["']?\\))`,"g"));w?Promise.all(w.map(k=>e.transformImgUrl(k))).then(k=>{i(k.reduce((y,p,b)=>y.replace(w[b],p),c))}):i(c),o.preventDefault();return}if(e.autoDetectCode&&o.clipboardData.types.includes("vscode-editor-data")){const w=JSON.parse(o.clipboardData.getData("vscode-editor-data"));E.emit(r,K,"code",{mode:w.mode,text:o.clipboardData.getData("text/plain")}),o.preventDefault();return}e.maxLength&&c.length+e.modelValue.length>e.maxLength&&E.emit(r,ye,{name:"overlength",message:"The input text is too long",data:c})},[t,r,i,e])};ke.EDIT_CONTEXT=!1;const xl=e=>{const{tabWidth:t,editorId:r,theme:i}=d.useContext(ee),o=d.useRef(null),n=d.useRef(),s=d.useRef(!0),[l]=d.useState(()=>({language:new Re,theme:new Re,autocompletion:new Re,update:new Re,domEvent:new Re,history:new Re})),[c]=d.useState(()=>vl(r,e)),g=d.useCallback(()=>[...c,...Zo,...Xo,Yo],[c]),f=bl(e,n),[u,h]=d.useState({}),v=d.useMemo(()=>{const p={paste:f,blur:e.onBlur,focus:e.onFocus,drop:e.onDrop,input:x=>{e.onInput&&e.onInput(x);const{data:T}=x;e.maxLength&&e.modelValue.length+T.length>e.maxLength&&E.emit(r,ye,{name:"overlength",message:"The input text is too long",data:T})}},b={...p},C=Object.keys(p);for(const x in u){const T=x;C.includes(T)?b[T]=(N,I)=>{u[T](N,I),N.defaultPrevented||p[T](N,I)}:b[T]=u[T]}return b},[u,r,f,e]),[w]=d.useState(()=>[Jo.of(g()),l.history.of(Yr()),l.language.of(en({codeLanguages:on})),ke.lineWrapping,l.update.of(ke.updateListener.of(p=>{p.docChanged&&e.onChange(p.state.doc.toString())})),l.domEvent.of(ke.domEventHandlers(v)),Qo()]),[k]=d.useState(()=>re.codeMirrorExtensions(i,[...w,l.theme.of(i==="light"?Ci:bi),l.autocompletion.of(Ei(e.completions))],g(),{editorId:r})),y=d.useCallback(()=>{var p,b;(p=n.current)==null||p.view.dispatch({effects:l.history.reconfigure([])}),(b=n.current)==null||b.view.dispatch({effects:l.history.reconfigure(Yr())})},[l.history]);return d.useEffect(()=>{const p=new ke({doc:e.modelValue,parent:o.current,extensions:k}),b=new Gs(p);n.current=b,setTimeout(()=>{b.setTabSize(t),b.setDisabled(e.disabled),b.setReadOnly(e.readOnly),e.placeholder&&b.setPlaceholder(e.placeholder),typeof e.maxLength=="number"&&b.setMaxLength(e.maxLength),e.autoFocus&&p.focus(),s.current=!1},0);const C=()=>tn(p),x=()=>rn(p),T=j=>{h(j)},N=(j,L)=>{const O=p.state.doc.line(j);p.dispatch(p.state.update({changes:{from:O.from,to:O.to,insert:L}}))},I=()=>{E.emit(r,mt,p)};return E.on(r,{name:St,callback:C}),E.on(r,{name:jt,callback:x}),E.on(r,{name:Nt,callback:T}),E.on(r,{name:Lt,callback:N}),E.on(r,{name:At,callback:I}),E.emit(r,mt,p),()=>{p.destroy(),E.remove(r,St,C),E.remove(r,jt,x),E.remove(r,Nt,T),E.remove(r,Lt,N),E.remove(r,At,I),s.current=!0}},[]),d.useEffect(()=>{const p=async(b,C={})=>{var x,T;if(b==="image"&&C.transform){const N=e.transformImgUrl(C.url);if(N instanceof Promise)N.then(async I=>{var j;const{text:L,options:O}=await kt(b,n.current,{...C,url:I});(j=n.current)==null||j.replaceSelectedText(L,O,r)}).catch(I=>{console.error(I)});else{const{text:I,options:j}=await kt(b,n.current,{...C,url:N});(x=n.current)==null||x.replaceSelectedText(I,j,r)}}else{const{text:N,options:I}=await kt(b,n.current,C);(T=n.current)==null||T.replaceSelectedText(N,I,r)}};return E.on(r,{name:K,callback:p}),()=>{E.remove(r,K,p)}},[r,e]),d.useEffect(()=>{setTimeout(()=>{var p;(p=n.current)==null||p.view.dispatch({effects:l.theme.reconfigure(i==="light"?Ci:bi)})},0)},[l.theme,i]),d.useEffect(()=>{setTimeout(()=>{var p;(p=n.current)==null||p.view.dispatch({effects:[l.update.reconfigure(ke.updateListener.of(b=>{b.docChanged&&e.onChange(b.state.doc.toString())})),l.domEvent.reconfigure(ke.domEventHandlers(v)),l.autocompletion.reconfigure(Ei(e.completions))]})},0)},[l.autocompletion,l.domEvent,l.update,v,e]),d.useEffect(()=>{var p,b;((p=n.current)==null?void 0:p.getValue())!==e.modelValue&&((b=n.current)==null||b.setValue(e.modelValue))},[e.modelValue]),d.useEffect(()=>{var p;s.current||(p=n.current)==null||p.setTabSize(t)},[t]),d.useEffect(()=>{var p;s.current||(p=n.current)==null||p.setPlaceholder(e.placeholder)},[e.placeholder]),d.useEffect(()=>{var p;s.current||(p=n.current)==null||p.setDisabled(e.disabled)},[e.disabled]),d.useEffect(()=>{var p;s.current||(p=n.current)==null||p.setDisabled(e.readOnly)},[e.readOnly]),d.useEffect(()=>{var p;s.current||typeof e.maxLength=="number"&&((p=n.current)==null||p.setMaxLength(e.maxLength))},[e.maxLength]),{inputWrapperRef:o,codeMirrorUt:n,resetHistory:y}},wl=(e,t,r)=>{const{inputBoxWidth:i,onInputBoxWidthChange:o}=e,n=d.useMemo(()=>/px$/.test(`${i}`)?"50%":i,[i]),[s,l]=d.useState({width:n}),[c,g]=d.useState({left:n}),f=d.useRef(n);return d.useEffect(()=>{const u=w=>{var k,y;const p=((k=t.current)==null?void 0:k.offsetWidth)||0,b=((y=t.current)==null?void 0:y.getBoundingClientRect().x)||0;let C=w.x-b;C/p<tt?C=p*tt:C>p-p*tt&&(C=p-p*tt);const x=`${C/p*100}%`;l(T=>({...T,width:x})),g(T=>({...T,left:x})),f.current=x,o?.(x)},h=w=>{w.target===r.current&&(g(k=>({...k})),document.addEventListener("mousemove",u))},v=()=>{g(w=>({...w})),document.removeEventListener("mousemove",u)};return document.addEventListener("mousedown",h),document.addEventListener("mouseup",v),()=>{document.removeEventListener("mousedown",h),document.removeEventListener("mouseup",v),document.removeEventListener("mousemove",u)}},[t,o,r]),d.useEffect(()=>{f.current=n,l(u=>({...u,width:n})),g(u=>({...u,left:n}))},[n]),d.useEffect(()=>{const u=e.setting.previewOnly;let h="",v="";u?(h="0%",v="none"):!e.setting.htmlPreview&&!e.setting.preview?(h="100%",v="none"):(h=f.current,v="initial"),l(w=>({...w,width:h})),g(w=>({...w,display:v}))},[e.setting.htmlPreview,e.setting.preview,e.setting.previewOnly]),{inputWrapperStyle:s,resizeOperateStyle:c}},kl=Ai(),$l=d.forwardRef((e,t)=>{const{onHtmlChanged:r}=e,{editorId:i}=d.useContext(ee),[o,n]=d.useState(""),s=d.useRef(null),l=d.useRef(null),c=d.useCallback(k=>{n(k),r?.(k)},[r]),{inputWrapperRef:g,codeMirrorUt:f,resetHistory:u}=xl(e),{inputWrapperStyle:h,resizeOperateStyle:v}=wl(e,s,l);Os(e,o,f),d.useImperativeHandle(t,()=>({getSelectedText(){var k;return(k=f.current)==null?void 0:k.getSelectedText()},focus(k){var y;(y=f.current)==null||y.focus(k)},resetHistory:u,getEditorView(){var k;return(k=f.current)==null?void 0:k.view}}),[f,u]);const w=d.useCallback((k,y)=>{var p,b;if(!e.setting.preview&&y.line!==void 0){k.preventDefault();const C=(p=f.current)==null?void 0:p.view;if(C){const x=C.state.doc.line(y.line+1),T=(b=C.lineBlockAt(x.from))==null?void 0:b.top,N=C.scrollDOM;kl(N,T)}}},[f,e.setting.preview]);return m.jsxs("div",{className:`${a}-content`,children:[m.jsxs("div",{className:`${a}-content-wrapper`,ref:s,children:[m.jsx("div",{className:`${a}-input-wrapper`,style:h,ref:g}),(e.setting.htmlPreview||e.setting.preview)&&m.jsx("div",{className:`${a}-resize-operate`,style:v,ref:l}),m.jsx(Vi,{modelValue:e.modelValue,onChange:e.onChange,setting:e.setting,onHtmlChanged:c,onGetCatalog:e.onGetCatalog,mdHeadingId:e.mdHeadingId,noMermaid:e.noMermaid,sanitize:e.sanitize,noKatex:e.noKatex,formatCopiedText:e.formatCopiedText,noHighlight:e.noHighlight,noImgZoomIn:e.noImgZoomIn,sanitizeMermaid:e.sanitizeMermaid,codeFoldable:e.codeFoldable,autoFoldThreshold:e.autoFoldThreshold,onRemount:e.onRemount})]}),e.catalogVisible&&m.jsx($s,{theme:e.theme,className:`${a}-catalog-editor ${a}-catalog-${e.catalogLayout}`,editorId:i,mdHeadingId:e.mdHeadingId,scrollElementOffsetTop:2,syncWith:e.setting.preview?"preview":"editor",onClick:w,catalogMaxDepth:e.catalogMaxDepth},"internal-catalog")]})}),yl=d.memo($l),Cl=({modelValue:e})=>{const{usedLanguageText:t}=d.useContext(ee);return d.useMemo(()=>{var r;return m.jsxs("div",{className:`${a}-footer-item`,children:[m.jsx("label",{className:`${a}-footer-label`,children:`${(r=t.footer)==null?void 0:r.markdownTotal}:`}),m.jsx("span",{children:e.length||0})]})},[t,e])},Tl=e=>{const t=d.useCallback(()=>{e.disabled||e.onChange(!e.checked)},[e]);return m.jsx("div",{className:P([`${a}-checkbox`,e.checked&&`${a}-checkbox-checked`,e.disabled&&`${a}-disabled`]),onClick:t})},El=e=>{var t;const{usedLanguageText:r,disabled:i}=d.useContext(ee);return d.useMemo(()=>{var o;return m.jsxs("div",{className:P([`${a}-footer-item`,i&&`${a}-disabled`]),children:[m.jsx("label",{className:`${a}-footer-label`,onClick:()=>{e.onScrollAutoChange(!e.scrollAuto)},children:(o=r.footer)==null?void 0:o.scrollAuto}),m.jsx(Tl,{disabled:i,checked:e.scrollAuto,onChange:e.onScrollAutoChange})]})},[(t=r.footer)==null?void 0:t.scrollAuto,i,e])},Sl=e=>{const{theme:t,language:r,disabled:i}=d.useContext(ee),o=d.useCallback(l=>{if(Oi.includes(l))switch(l){case"markdownTotal":return m.jsx(Cl,{modelValue:e.modelValue},"markdown-total");case"scrollSwitch":return!e.noScrollAuto&&m.jsx(El,{scrollAuto:e.scrollAuto,onScrollAutoChange:e.onScrollAutoChange},"scroll-auto")}else{const c=e.defFooters[l];return typeof c!="string"?d.cloneElement(c,{theme:c.props.theme||t,language:c.props.language||r,disabled:c.props.disabled||i}):c||""}},[e.modelValue,e.noScrollAuto,e.scrollAuto,e.onScrollAutoChange,e.defFooters,t,r,i]),[n,s]=d.useMemo(()=>{const l=e.footers.indexOf("="),c=l===-1?e.footers:e.footers.slice(0,l),g=l===-1?[]:e.footers.slice(l,Number.MAX_SAFE_INTEGER);return[c.map(f=>o(f)),g.map(f=>o(f))]},[e.footers,o]);return m.jsxs("div",{className:`${a}-footer`,children:[m.jsx("div",{className:`${a}-footer-left`,children:n}),m.jsx("div",{className:`${a}-footer-right`,children:s})]})},jl=d.memo(Sl),Ma=d.forwardRef((e,t)=>{const{value:r=e.modelValue||A.modelValue,theme:i=A.theme,codeTheme:o=A.codeTheme,className:n=A.className,toolbars:s=A.toolbars,toolbarsExclude:l=A.toolbarsExclude,defToolbars:c=A.defToolbars,tabWidth:g=A.tabWidth,showCodeRowNumber:f=A.showCodeRowNumber,previewTheme:u=A.previewTheme,noPrettier:h=A.noPrettier,tableShape:v=A.tableShape,noMermaid:w=A.noMermaid,noKatex:k=A.noKatex,placeholder:y=A.placeholder,onChange:p=A.onChange,onHtmlChanged:b=A.onHtmlChanged,onGetCatalog:C=A.onGetCatalog,sanitize:x=A.sanitize,onError:T=A.onError,mdHeadingId:N=A.mdHeadingId,footers:I=A.footers,defFooters:j=A.defFooters,noUploadImg:L=A.noUploadImg,noHighlight:O=A.noHighlight,noImgZoomIn:F=A.noImgZoomIn,language:_=A.language,inputBoxWidth:M=A.inputBoxWidth,sanitizeMermaid:H=A.sanitizeMermaid,transformImgUrl:G=A.transformImgUrl,codeFoldable:Z=A.codeFoldable,autoFoldThreshold:q=A.autoFoldThreshold,catalogLayout:V=A.catalogLayout}=e,ie=zi(e),[W]=d.useState(()=>({editorId:ie,noKatex:k,noMermaid:w,noPrettier:h,noUploadImg:L,noHighlight:O})),[se,J]=d.useState(()=>({scrollAuto:e.scrollAuto===void 0?!0:e.scrollAuto})),X=d.useRef(null),oe=d.useRef(),Le=d.useCallback(be=>{J(Fe=>({...Fe,scrollAuto:be}))},[J]);Ln(e,W),An(W),Mn(e,W),Rn(W.editorId,T);const pe=Fn(e,W),[B,de,ne,ue]=Pi(e);return On(t,W,pe,ne,ue,oe),d.useEffect(()=>()=>{E.clear(W.editorId)},[W.editorId]),m.jsx(ee.Provider,{value:{editorId:W.editorId,tabWidth:g,theme:i,language:_,highlight:B,showCodeRowNumber:f,usedLanguageText:de,previewTheme:u,customIcon:e.customIcon||{},rootRef:X,disabled:e.disabled},children:m.jsxs("div",{id:W.editorId,className:P([a,!!n&&n,i==="dark"&&`${a}-dark`,(ne.fullscreen||ne.pageFullscreen)&&`${a}-fullscreen`]),style:e.style,ref:X,children:[s.length>0&&m.jsx(Fs,{noPrettier:W.noPrettier,toolbars:s,toolbarsExclude:l,setting:ne,updateSetting:ue,tableShape:v,defToolbars:c,noUploadImg:W.noUploadImg,showToolbarName:e.showToolbarName,catalogVisible:pe,codeTheme:o,insertLinkDirect:e.insertLinkDirect}),m.jsx(yl,{ref:oe,modelValue:r,onChange:p,setting:ne,mdHeadingId:N,onHtmlChanged:b,onGetCatalog:C,sanitize:x,noMermaid:W.noMermaid,noPrettier:W.noPrettier,noHighlight:W.noHighlight,placeholder:y,noKatex:W.noKatex,scrollAuto:se.scrollAuto,formatCopiedText:e.formatCopiedText,autoFocus:e.autoFocus,disabled:e.disabled,readOnly:e.readOnly,maxLength:e.maxLength,autoDetectCode:e.autoDetectCode,onBlur:e.onBlur,onFocus:e.onFocus,onInput:e.onInput,completions:e.completions,catalogVisible:pe,theme:e.theme,noImgZoomIn:F,onDrop:e.onDrop,inputBoxWidth:M,onInputBoxWidthChange:e.onInputBoxWidthChange,sanitizeMermaid:H,transformImgUrl:G,codeFoldable:Z,autoFoldThreshold:q,onRemount:e.onRemount,catalogLayout:V,catalogMaxDepth:e.catalogMaxDepth}),I.length>0&&m.jsx(jl,{modelValue:r,footers:I,defFooters:j,noScrollAuto:!ne.preview&&!ne.htmlPreview||ne.previewOnly,scrollAuto:se.scrollAuto,onScrollAutoChange:Le})]})})}),Il=(e,t)=>{const{editorId:r}=e;d.useImperativeHandle(t,()=>({rerender(){E.emit(r,ut)}}),[r])},Fa=d.forwardRef((e,t)=>{const{value:r=e.modelValue||A.modelValue,onChange:i=A.onChange,theme:o=A.theme,className:n=A.className,showCodeRowNumber:s=A.showCodeRowNumber,previewTheme:l=A.previewTheme,noMermaid:c=A.noMermaid,noKatex:g=A.noKatex,onHtmlChanged:f=A.onHtmlChanged,onGetCatalog:u=A.onGetCatalog,sanitize:h=A.sanitize,mdHeadingId:v=A.mdHeadingId,noHighlight:w=A.noHighlight,noImgZoomIn:k=A.noImgZoomIn,language:y=A.language,sanitizeMermaid:p=A.sanitizeMermaid,codeFoldable:b=A.codeFoldable,autoFoldThreshold:C=A.autoFoldThreshold}=e,x=zi(e),[T]=d.useState(()=>({editorId:x,noKatex:g,noMermaid:c,noHighlight:w})),N=d.useRef(null),[I,j,L]=Pi(e);return Il(T,t),d.useEffect(()=>()=>{E.clear(x)},[x]),m.jsx(ee.Provider,{value:{editorId:T.editorId,tabWidth:2,theme:o,language:y,highlight:I,showCodeRowNumber:s,usedLanguageText:j,previewTheme:l,customIcon:e.customIcon||{},rootRef:N,disabled:!1},children:m.jsx("div",{id:T.editorId,className:P([a,n,o==="dark"&&`${a}-dark`,L.fullscreen||L.pageFullscreen?`${a}-fullscreen`:"",`${a}-previewOnly`]),style:e.style,ref:N,children:m.jsx(Vi,{modelValue:r,onChange:i,setting:L,mdHeadingId:v,onHtmlChanged:f,onGetCatalog:u,sanitize:h,noMermaid:T.noMermaid,noHighlight:T.noHighlight,noKatex:T.noKatex,formatCopiedText:e.formatCopiedText,noImgZoomIn:k,previewOnly:!0,sanitizeMermaid:p,codeFoldable:b,autoFoldThreshold:C,onRemount:e.onRemount},"preview-only")})})});var Si={exports:{}},te={},Ot={exports:{}},Me={};function Ui(){var e={};return e["align-content"]=!1,e["align-items"]=!1,e["align-self"]=!1,e["alignment-adjust"]=!1,e["alignment-baseline"]=!1,e.all=!1,e["anchor-point"]=!1,e.animation=!1,e["animation-delay"]=!1,e["animation-direction"]=!1,e["animation-duration"]=!1,e["animation-fill-mode"]=!1,e["animation-iteration-count"]=!1,e["animation-name"]=!1,e["animation-play-state"]=!1,e["animation-timing-function"]=!1,e.azimuth=!1,e["backface-visibility"]=!1,e.background=!0,e["background-attachment"]=!0,e["background-clip"]=!0,e["background-color"]=!0,e["background-image"]=!0,e["background-origin"]=!0,e["background-position"]=!0,e["background-repeat"]=!0,e["background-size"]=!0,e["baseline-shift"]=!1,e.binding=!1,e.bleed=!1,e["bookmark-label"]=!1,e["bookmark-level"]=!1,e["bookmark-state"]=!1,e.border=!0,e["border-bottom"]=!0,e["border-bottom-color"]=!0,e["border-bottom-left-radius"]=!0,e["border-bottom-right-radius"]=!0,e["border-bottom-style"]=!0,e["border-bottom-width"]=!0,e["border-collapse"]=!0,e["border-color"]=!0,e["border-image"]=!0,e["border-image-outset"]=!0,e["border-image-repeat"]=!0,e["border-image-slice"]=!0,e["border-image-source"]=!0,e["border-image-width"]=!0,e["border-left"]=!0,e["border-left-color"]=!0,e["border-left-style"]=!0,e["border-left-width"]=!0,e["border-radius"]=!0,e["border-right"]=!0,e["border-right-color"]=!0,e["border-right-style"]=!0,e["border-right-width"]=!0,e["border-spacing"]=!0,e["border-style"]=!0,e["border-top"]=!0,e["border-top-color"]=!0,e["border-top-left-radius"]=!0,e["border-top-right-radius"]=!0,e["border-top-style"]=!0,e["border-top-width"]=!0,e["border-width"]=!0,e.bottom=!1,e["box-decoration-break"]=!0,e["box-shadow"]=!0,e["box-sizing"]=!0,e["box-snap"]=!0,e["box-suppress"]=!0,e["break-after"]=!0,e["break-before"]=!0,e["break-inside"]=!0,e["caption-side"]=!1,e.chains=!1,e.clear=!0,e.clip=!1,e["clip-path"]=!1,e["clip-rule"]=!1,e.color=!0,e["color-interpolation-filters"]=!0,e["column-count"]=!1,e["column-fill"]=!1,e["column-gap"]=!1,e["column-rule"]=!1,e["column-rule-color"]=!1,e["column-rule-style"]=!1,e["column-rule-width"]=!1,e["column-span"]=!1,e["column-width"]=!1,e.columns=!1,e.contain=!1,e.content=!1,e["counter-increment"]=!1,e["counter-reset"]=!1,e["counter-set"]=!1,e.crop=!1,e.cue=!1,e["cue-after"]=!1,e["cue-before"]=!1,e.cursor=!1,e.direction=!1,e.display=!0,e["display-inside"]=!0,e["display-list"]=!0,e["display-outside"]=!0,e["dominant-baseline"]=!1,e.elevation=!1,e["empty-cells"]=!1,e.filter=!1,e.flex=!1,e["flex-basis"]=!1,e["flex-direction"]=!1,e["flex-flow"]=!1,e["flex-grow"]=!1,e["flex-shrink"]=!1,e["flex-wrap"]=!1,e.float=!1,e["float-offset"]=!1,e["flood-color"]=!1,e["flood-opacity"]=!1,e["flow-from"]=!1,e["flow-into"]=!1,e.font=!0,e["font-family"]=!0,e["font-feature-settings"]=!0,e["font-kerning"]=!0,e["font-language-override"]=!0,e["font-size"]=!0,e["font-size-adjust"]=!0,e["font-stretch"]=!0,e["font-style"]=!0,e["font-synthesis"]=!0,e["font-variant"]=!0,e["font-variant-alternates"]=!0,e["font-variant-caps"]=!0,e["font-variant-east-asian"]=!0,e["font-variant-ligatures"]=!0,e["font-variant-numeric"]=!0,e["font-variant-position"]=!0,e["font-weight"]=!0,e.grid=!1,e["grid-area"]=!1,e["grid-auto-columns"]=!1,e["grid-auto-flow"]=!1,e["grid-auto-rows"]=!1,e["grid-column"]=!1,e["grid-column-end"]=!1,e["grid-column-start"]=!1,e["grid-row"]=!1,e["grid-row-end"]=!1,e["grid-row-start"]=!1,e["grid-template"]=!1,e["grid-template-areas"]=!1,e["grid-template-columns"]=!1,e["grid-template-rows"]=!1,e["hanging-punctuation"]=!1,e.height=!0,e.hyphens=!1,e.icon=!1,e["image-orientation"]=!1,e["image-resolution"]=!1,e["ime-mode"]=!1,e["initial-letters"]=!1,e["inline-box-align"]=!1,e["justify-content"]=!1,e["justify-items"]=!1,e["justify-self"]=!1,e.left=!1,e["letter-spacing"]=!0,e["lighting-color"]=!0,e["line-box-contain"]=!1,e["line-break"]=!1,e["line-grid"]=!1,e["line-height"]=!1,e["line-snap"]=!1,e["line-stacking"]=!1,e["line-stacking-ruby"]=!1,e["line-stacking-shift"]=!1,e["line-stacking-strategy"]=!1,e["list-style"]=!0,e["list-style-image"]=!0,e["list-style-position"]=!0,e["list-style-type"]=!0,e.margin=!0,e["margin-bottom"]=!0,e["margin-left"]=!0,e["margin-right"]=!0,e["margin-top"]=!0,e["marker-offset"]=!1,e["marker-side"]=!1,e.marks=!1,e.mask=!1,e["mask-box"]=!1,e["mask-box-outset"]=!1,e["mask-box-repeat"]=!1,e["mask-box-slice"]=!1,e["mask-box-source"]=!1,e["mask-box-width"]=!1,e["mask-clip"]=!1,e["mask-image"]=!1,e["mask-origin"]=!1,e["mask-position"]=!1,e["mask-repeat"]=!1,e["mask-size"]=!1,e["mask-source-type"]=!1,e["mask-type"]=!1,e["max-height"]=!0,e["max-lines"]=!1,e["max-width"]=!0,e["min-height"]=!0,e["min-width"]=!0,e["move-to"]=!1,e["nav-down"]=!1,e["nav-index"]=!1,e["nav-left"]=!1,e["nav-right"]=!1,e["nav-up"]=!1,e["object-fit"]=!1,e["object-position"]=!1,e.opacity=!1,e.order=!1,e.orphans=!1,e.outline=!1,e["outline-color"]=!1,e["outline-offset"]=!1,e["outline-style"]=!1,e["outline-width"]=!1,e.overflow=!1,e["overflow-wrap"]=!1,e["overflow-x"]=!1,e["overflow-y"]=!1,e.padding=!0,e["padding-bottom"]=!0,e["padding-left"]=!0,e["padding-right"]=!0,e["padding-top"]=!0,e.page=!1,e["page-break-after"]=!1,e["page-break-before"]=!1,e["page-break-inside"]=!1,e["page-policy"]=!1,e.pause=!1,e["pause-after"]=!1,e["pause-before"]=!1,e.perspective=!1,e["perspective-origin"]=!1,e.pitch=!1,e["pitch-range"]=!1,e["play-during"]=!1,e.position=!1,e["presentation-level"]=!1,e.quotes=!1,e["region-fragment"]=!1,e.resize=!1,e.rest=!1,e["rest-after"]=!1,e["rest-before"]=!1,e.richness=!1,e.right=!1,e.rotation=!1,e["rotation-point"]=!1,e["ruby-align"]=!1,e["ruby-merge"]=!1,e["ruby-position"]=!1,e["shape-image-threshold"]=!1,e["shape-outside"]=!1,e["shape-margin"]=!1,e.size=!1,e.speak=!1,e["speak-as"]=!1,e["speak-header"]=!1,e["speak-numeral"]=!1,e["speak-punctuation"]=!1,e["speech-rate"]=!1,e.stress=!1,e["string-set"]=!1,e["tab-size"]=!1,e["table-layout"]=!1,e["text-align"]=!0,e["text-align-last"]=!0,e["text-combine-upright"]=!0,e["text-decoration"]=!0,e["text-decoration-color"]=!0,e["text-decoration-line"]=!0,e["text-decoration-skip"]=!0,e["text-decoration-style"]=!0,e["text-emphasis"]=!0,e["text-emphasis-color"]=!0,e["text-emphasis-position"]=!0,e["text-emphasis-style"]=!0,e["text-height"]=!0,e["text-indent"]=!0,e["text-justify"]=!0,e["text-orientation"]=!0,e["text-overflow"]=!0,e["text-shadow"]=!0,e["text-space-collapse"]=!0,e["text-transform"]=!0,e["text-underline-position"]=!0,e["text-wrap"]=!0,e.top=!1,e.transform=!1,e["transform-origin"]=!1,e["transform-style"]=!1,e.transition=!1,e["transition-delay"]=!1,e["transition-duration"]=!1,e["transition-property"]=!1,e["transition-timing-function"]=!1,e["unicode-bidi"]=!1,e["vertical-align"]=!1,e.visibility=!1,e["voice-balance"]=!1,e["voice-duration"]=!1,e["voice-family"]=!1,e["voice-pitch"]=!1,e["voice-range"]=!1,e["voice-rate"]=!1,e["voice-stress"]=!1,e["voice-volume"]=!1,e.volume=!1,e["white-space"]=!1,e.widows=!1,e.width=!0,e["will-change"]=!1,e["word-break"]=!0,e["word-spacing"]=!0,e["word-wrap"]=!0,e["wrap-flow"]=!1,e["wrap-through"]=!1,e["writing-mode"]=!1,e["z-index"]=!1,e}function Nl(e,t,r){}function Ll(e,t,r){}var Al=/javascript\s*\:/img;function Rl(e,t){return Al.test(t)?"":t}Me.whiteList=Ui();Me.getDefaultWhiteList=Ui;Me.onAttr=Nl;Me.onIgnoreAttr=Ll;Me.safeAttrValue=Rl;var Ml={indexOf:function(e,t){var r,i;if(Array.prototype.indexOf)return e.indexOf(t);for(r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1},forEach:function(e,t,r){var i,o;if(Array.prototype.forEach)return e.forEach(t,r);for(i=0,o=e.length;i<o;i++)t.call(r,e[i],i,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}},Ke=Ml;function Fl(e,t){e=Ke.trimRight(e),e[e.length-1]!==";"&&(e+=";");var r=e.length,i=!1,o=0,n=0,s="";function l(){if(!i){var f=Ke.trim(e.slice(o,n)),u=f.indexOf(":");if(u!==-1){var h=Ke.trim(f.slice(0,u)),v=Ke.trim(f.slice(u+1));if(h){var w=t(o,s.length,h,v,f);w&&(s+=w+"; ")}}}o=n+1}for(;n<r;n++){var c=e[n];if(c==="/"&&e[n+1]==="*"){var g=e.indexOf("*/",n+2);if(g===-1)break;n=g+1,o=n+1,i=!1}else c==="("?i=!0:c===")"?i=!1:c===";"?i||l():c===`
`&&l()}return Ke.trim(s)}var Ol=Fl,it=Me,Hl=Ol;function ji(e){return e==null}function _l(e){var t={};for(var r in e)t[r]=e[r];return t}function Ki(e){e=_l(e||{}),e.whiteList=e.whiteList||it.whiteList,e.onAttr=e.onAttr||it.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||it.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||it.safeAttrValue,this.options=e}Ki.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,r=t.options,i=r.whiteList,o=r.onAttr,n=r.onIgnoreAttr,s=r.safeAttrValue,l=Hl(e,function(c,g,f,u,h){var v=i[f],w=!1;if(v===!0?w=v:typeof v=="function"?w=v(u):v instanceof RegExp&&(w=v.test(u)),w!==!0&&(w=!1),u=s(f,u),!!u){var k={position:g,sourcePosition:c,source:h,isWhite:w};if(w){var y=o(f,u,k);return ji(y)?f+":"+u:y}else{var y=n(f,u,k);if(!ji(y))return y}}});return l};var Dl=Ki;(function(e,t){var r=Me,i=Dl;function o(s,l){var c=new i(l);return c.process(s)}t=e.exports=o,t.FilterCSS=i;for(var n in r)t[n]=r[n];typeof window<"u"&&(window.filterCSS=e.exports)})(Ot,Ot.exports);var Dt=Ot.exports,Pt={indexOf:function(e,t){var r,i;if(Array.prototype.indexOf)return e.indexOf(t);for(r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1},forEach:function(e,t,r){var i,o;if(Array.prototype.forEach)return e.forEach(t,r);for(i=0,o=e.length;i<o;i++)t.call(r,e[i],i,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(e){var t=/\s|\n|\t/,r=t.exec(e);return r?r.index:-1}},Pl=Dt.FilterCSS,zl=Dt.getDefaultWhiteList,pt=Pt;function Gi(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height","loading"],ins:["datetime"],kbd:[],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var Zi=new Pl;function Vl(e,t,r){}function Wl(e,t,r){}function ql(e,t,r){}function Bl(e,t,r){}function Xi(e){return e.replace(Kl,"&lt;").replace(Gl,"&gt;")}function Ul(e,t,r,i){if(r=ro(r),t==="href"||t==="src"){if(r=pt.trim(r),r==="#")return"#";if(!(r.substr(0,7)==="http://"||r.substr(0,8)==="https://"||r.substr(0,7)==="mailto:"||r.substr(0,4)==="tel:"||r.substr(0,11)==="data:image/"||r.substr(0,6)==="ftp://"||r.substr(0,2)==="./"||r.substr(0,3)==="../"||r[0]==="#"||r[0]==="/"))return""}else if(t==="background"){if(ot.lastIndex=0,ot.test(r))return""}else if(t==="style"){if(Ii.lastIndex=0,Ii.test(r)||(Ni.lastIndex=0,Ni.test(r)&&(ot.lastIndex=0,ot.test(r))))return"";i!==!1&&(i=i||Zi,r=i.process(r))}return r=io(r),r}var Kl=/</g,Gl=/>/g,Zl=/"/g,Xl=/&quot;/g,Yl=/&#([a-zA-Z0-9]*);?/gim,Jl=/&colon;?/gim,Ql=/&newline;?/gim,ot=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,Ii=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,Ni=/u\s*r\s*l\s*\(.*/gi;function Yi(e){return e.replace(Zl,"&quot;")}function Ji(e){return e.replace(Xl,'"')}function Qi(e){return e.replace(Yl,function(t,r){return r[0]==="x"||r[0]==="X"?String.fromCharCode(parseInt(r.substr(1),16)):String.fromCharCode(parseInt(r,10))})}function eo(e){return e.replace(Jl,":").replace(Ql," ")}function to(e){for(var t="",r=0,i=e.length;r<i;r++)t+=e.charCodeAt(r)<32?" ":e.charAt(r);return pt.trim(t)}function ro(e){return e=Ji(e),e=Qi(e),e=eo(e),e=to(e),e}function io(e){return e=Yi(e),e=Xi(e),e}function ea(){return""}function ta(e,t){typeof t!="function"&&(t=function(){});var r=!Array.isArray(e);function i(s){return r?!0:pt.indexOf(e,s)!==-1}var o=[],n=!1;return{onIgnoreTag:function(s,l,c){if(i(s))if(c.isClosing){var g="[/removed]",f=c.position+g.length;return o.push([n!==!1?n:c.position,f]),n=!1,g}else return n||(n=c.position),"[removed]";else return t(s,l,c)},remove:function(s){var l="",c=0;return pt.forEach(o,function(g){l+=s.slice(c,g[0]),c=g[1]}),l+=s.slice(c),l}}}function ra(e){for(var t="",r=0;r<e.length;){var i=e.indexOf("<!--",r);if(i===-1){t+=e.slice(r);break}t+=e.slice(r,i);var o=e.indexOf("-->",i);if(o===-1)break;r=o+3}return t}function ia(e){var t=e.split("");return t=t.filter(function(r){var i=r.charCodeAt(0);return i===127?!1:i<=31?i===10||i===13:!0}),t.join("")}te.whiteList=Gi();te.getDefaultWhiteList=Gi;te.onTag=Vl;te.onIgnoreTag=Wl;te.onTagAttr=ql;te.onIgnoreTagAttr=Bl;te.safeAttrValue=Ul;te.escapeHtml=Xi;te.escapeQuote=Yi;te.unescapeQuote=Ji;te.escapeHtmlEntities=Qi;te.escapeDangerHtml5Entities=eo;te.clearNonPrintableCharacter=to;te.friendlyAttrValue=ro;te.escapeAttrValue=io;te.onIgnoreTagStripAll=ea;te.StripTagBody=ta;te.stripCommentTag=ra;te.stripBlankChar=ia;te.attributeWrapSign='"';te.cssFilter=Zi;te.getDefaultCSSWhiteList=zl;var gt={},Ne=Pt;function oa(e){var t=Ne.spaceIndex(e),r;return t===-1?r=e.slice(1,-1):r=e.slice(1,t+1),r=Ne.trim(r).toLowerCase(),r.slice(0,1)==="/"&&(r=r.slice(1)),r.slice(-1)==="/"&&(r=r.slice(0,-1)),r}function na(e){return e.slice(0,2)==="</"}function sa(e,t,r){var i="",o=0,n=!1,s=!1,l=0,c=e.length,g="",f="";e:for(l=0;l<c;l++){var u=e.charAt(l);if(n===!1){if(u==="<"){n=l;continue}}else if(s===!1){if(u==="<"){i+=r(e.slice(o,l)),n=l,o=l;continue}if(u===">"||l===c-1){i+=r(e.slice(o,n)),f=e.slice(n,l+1),g=oa(f),i+=t(n,i.length,g,f,na(f)),o=l+1,n=!1;continue}if(u==='"'||u==="'")for(var h=1,v=e.charAt(l-h);v.trim()===""||v==="=";){if(v==="="){s=u;continue e}v=e.charAt(l-++h)}}else if(u===s){s=!1;continue}}return o<c&&(i+=r(e.substr(o))),i}var la=/[^a-zA-Z0-9\\_:.-]/gim;function aa(e,t){var r=0,i=0,o=[],n=!1,s=e.length;function l(h,v){if(h=Ne.trim(h),h=h.replace(la,"").toLowerCase(),!(h.length<1)){var w=t(h,v||"");w&&o.push(w)}}for(var c=0;c<s;c++){var g=e.charAt(c),f,u;if(n===!1&&g==="="){n=e.slice(r,c),r=c+1,i=e.charAt(r)==='"'||e.charAt(r)==="'"?r:da(e,c+1);continue}if(n!==!1&&c===i){if(u=e.indexOf(g,c+1),u===-1)break;f=Ne.trim(e.slice(i+1,u)),l(n,f),n=!1,c=u,r=c+1;continue}if(/\s|\n|\t/.test(g))if(e=e.replace(/\s|\n|\t/g," "),n===!1)if(u=ca(e,c),u===-1){f=Ne.trim(e.slice(r,c)),l(f),n=!1,r=c+1;continue}else{c=u-1;continue}else if(u=ua(e,c-1),u===-1){f=Ne.trim(e.slice(r,c)),f=Li(f),l(n,f),n=!1,r=c+1;continue}else continue}return r<e.length&&(n===!1?l(e.slice(r)):l(n,Li(Ne.trim(e.slice(r))))),Ne.trim(o.join(" "))}function ca(e,t){for(;t<e.length;t++){var r=e[t];if(r!==" ")return r==="="?t:-1}}function da(e,t){for(;t<e.length;t++){var r=e[t];if(r!==" ")return r==="'"||r==='"'?t:-1}}function ua(e,t){for(;t>0;t--){var r=e[t];if(r!==" ")return r==="="?t:-1}}function ma(e){return e[0]==='"'&&e[e.length-1]==='"'||e[0]==="'"&&e[e.length-1]==="'"}function Li(e){return ma(e)?e.substr(1,e.length-2):e}gt.parseTag=sa;gt.parseAttr=aa;var ha=Dt.FilterCSS,fe=te,oo=gt,fa=oo.parseTag,pa=oo.parseAttr,ct=Pt;function nt(e){return e==null}function ga(e){var t=ct.spaceIndex(e);if(t===-1)return{html:"",closing:e[e.length-2]==="/"};e=ct.trim(e.slice(t+1,-1));var r=e[e.length-1]==="/";return r&&(e=ct.trim(e.slice(0,-1))),{html:e,closing:r}}function va(e){var t={};for(var r in e)t[r]=e[r];return t}function ba(e){var t={};for(var r in e)Array.isArray(e[r])?t[r.toLowerCase()]=e[r].map(function(i){return i.toLowerCase()}):t[r.toLowerCase()]=e[r];return t}function no(e){e=va(e||{}),e.stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=fe.onIgnoreTagStripAll),e.whiteList||e.allowList?e.whiteList=ba(e.whiteList||e.allowList):e.whiteList=fe.whiteList,this.attributeWrapSign=e.singleQuotedAttributeValue===!0?"'":fe.attributeWrapSign,e.onTag=e.onTag||fe.onTag,e.onTagAttr=e.onTagAttr||fe.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||fe.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||fe.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||fe.safeAttrValue,e.escapeHtml=e.escapeHtml||fe.escapeHtml,this.options=e,e.css===!1?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new ha(e.css))}no.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,r=t.options,i=r.whiteList,o=r.onTag,n=r.onIgnoreTag,s=r.onTagAttr,l=r.onIgnoreTagAttr,c=r.safeAttrValue,g=r.escapeHtml,f=t.attributeWrapSign,u=t.cssFilter;r.stripBlankChar&&(e=fe.stripBlankChar(e)),r.allowCommentTag||(e=fe.stripCommentTag(e));var h=!1;r.stripIgnoreTagBody&&(h=fe.StripTagBody(r.stripIgnoreTagBody,n),n=h.onIgnoreTag);var v=fa(e,function(w,k,y,p,b){var C={sourcePosition:w,position:k,isClosing:b,isWhite:Object.prototype.hasOwnProperty.call(i,y)},x=o(y,p,C);if(!nt(x))return x;if(C.isWhite){if(C.isClosing)return"</"+y+">";var T=ga(p),N=i[y],I=pa(T.html,function(j,L){var O=ct.indexOf(N,j)!==-1,F=s(y,j,L,O);return nt(F)?O?(L=c(y,j,L,u),L?j+"="+f+L+f:j):(F=l(y,j,L,O),nt(F)?void 0:F):F});return p="<"+y,I&&(p+=" "+I),T.closing&&(p+=" /"),p+=">",p}else return x=n(y,p,C),nt(x)?g(p):x},g);return h&&(v=h.remove(v)),v};var xa=no;(function(e,t){var r=te,i=gt,o=xa;function n(l,c){var g=new o(c);return g.process(l)}t=e.exports=n,t.filterXSS=n,t.FilterXSS=o,(function(){for(var l in r)t[l]=r[l];for(var c in i)t[c]=i[c]})(),typeof window<"u"&&(window.filterXSS=e.exports);function s(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}s()&&(self.filterXSS=e.exports)})(Si,Si.exports);export{Fa as Q,Ma as i};
